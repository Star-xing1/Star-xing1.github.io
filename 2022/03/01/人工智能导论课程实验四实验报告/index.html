<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>人工智能导论课程实验四 | Star's Wrold</title><meta name="author" content="Star"><meta name="copyright" content="Star"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="人工智能导论课程实验四实验报告一、实验名称：深度学习算法及应用二、实验环境 AI Studio Python3 开源深度学习工具：Paddle，CUDA  三、实验目的 了解深度学习的基本原理  能够使用深度学习开源工具  应用深度学习算法求解实际问题  基于CNN实现多情况下的手写数字识别   四、实验算法及原理深度学习与卷积神经网络CNN 深度学习的思想：  深度神经网络的基本思想是通过构建多">
<meta property="og:type" content="article">
<meta property="og:title" content="人工智能导论课程实验四">
<meta property="og:url" content="http://example.com/2022/03/01/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/index.html">
<meta property="og:site_name" content="Star&#39;s Wrold">
<meta property="og:description" content="人工智能导论课程实验四实验报告一、实验名称：深度学习算法及应用二、实验环境 AI Studio Python3 开源深度学习工具：Paddle，CUDA  三、实验目的 了解深度学习的基本原理  能够使用深度学习开源工具  应用深度学习算法求解实际问题  基于CNN实现多情况下的手写数字识别   四、实验算法及原理深度学习与卷积神经网络CNN 深度学习的思想：  深度神经网络的基本思想是通过构建多">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2022-03-01T15:20:13.591Z">
<meta property="article:modified_time" content="2022-03-01T15:18:17.274Z">
<meta property="article:author" content="Star">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/img/favicon1.png"><link rel="canonical" href="http://example.com/2022/03/01/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '人工智能导论课程实验四',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-01 23:18:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/83267809?s=400&amp;u=e07dedcddde59bae22039fbfb223e27ee9c35a29&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Star's Wrold</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">人工智能导论课程实验四</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-01T15:20:13.591Z" title="发表于 2022-03-01 23:20:13">2022-03-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-01T15:18:17.274Z" title="更新于 2022-03-01 23:18:17">2022-03-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="人工智能导论课程实验四"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="人工智能导论课程实验四实验报告"><a href="#人工智能导论课程实验四实验报告" class="headerlink" title="人工智能导论课程实验四实验报告"></a>人工智能导论课程实验四实验报告</h1><h2 id="一、实验名称：深度学习算法及应用"><a href="#一、实验名称：深度学习算法及应用" class="headerlink" title="一、实验名称：深度学习算法及应用"></a>一、实验名称：深度学习算法及应用</h2><h2 id="二、实验环境"><a href="#二、实验环境" class="headerlink" title="二、实验环境"></a>二、实验环境</h2><ul>
<li>AI Studio</li>
<li>Python3</li>
<li>开源深度学习工具：Paddle，CUDA</li>
</ul>
<h2 id="三、实验目的"><a href="#三、实验目的" class="headerlink" title="三、实验目的"></a>三、实验目的</h2><ol>
<li><p>了解深度学习的基本原理</p>
</li>
<li><p>能够使用深度学习开源工具</p>
</li>
<li><p>应用深度学习算法求解实际问题</p>
</li>
<li><p>基于CNN实现多情况下的手写数字识别</p>
</li>
</ol>
<h2 id="四、实验算法及原理"><a href="#四、实验算法及原理" class="headerlink" title="四、实验算法及原理"></a>四、实验算法及原理</h2><h3 id="深度学习与卷积神经网络CNN"><a href="#深度学习与卷积神经网络CNN" class="headerlink" title="深度学习与卷积神经网络CNN"></a>深度学习与卷积神经网络CNN</h3><ul>
<li>深度学习的思想：</li>
</ul>
<p>深度神经网络的基本思想是通过构建多层网络，对目标进行多层表示，以期通过多层的高层次特征来表示数据的抽象语义信息，获得更好的特征鲁棒性。</p>
<ul>
<li>什么是卷积神经网络(CNN)：</li>
</ul>
<p><strong>卷积神经网络是一种带有卷积结构的深度神经网络，卷积结构可以减少深层网络占用的内存量，其三个关键的操作，其一是局部感受野，其二是权值共享，其三是pooling层，有效的减少了网络的参数个数，缓解了模型的过拟合问题。</strong></p>
<p><strong>1）网络结构</strong></p>
<p><strong>卷积神经网络整体架构：</strong>卷积神经网络是一种多层的监督学习神经网络，隐含层的卷积层和池采样层是实现卷积神经网络特征提取功能的核心模块。该网络模型通过采用梯度下降法最小化损失函数对网络中的权重参数逐层反向调节，通过频繁的迭代训练提高网络的精度。卷积神经网络的低隐层是由卷积层和最大池采样层交替组成，高层是全连接层对应传统多层感知器的隐含层和逻辑回归分类器。第一个全连接层的输入是由卷积层和子采样层进行特征提取得到的特征图像。最后一层输出层是一个分类器，可以采用逻辑回归，Softmax回归甚至是支持向量机对输入图像进行分类。</p>
<p><strong>卷积神经网络结构包括：卷积层，降采样层，全链接层。每一层有多个特征图，每个特征图通过一种卷积滤波器提取输入的一种特征，每个特征图有多个神经元。</strong></p>
<p>输入图像统计和滤波器进行卷积之后，提取该局部特征，一旦该局部特征被提取出来之后，它与其他特征的位置关系也随之确定下来了，每个神经元的输入和前一层的局部感受野相连，每个特征提取层都紧跟一个用来求局部平均与二次提取的计算层，也叫特征映射层，网络的每个计算层由多个特征映射平面组成，平面上所有的神经元的权重相等。</p>
<p><strong>通常将输入层到隐藏层的映射称为一个特征映射，也就是通过卷积层得到特征提取层，经过pooling之后得到特征映射层。</strong></p>
<p><strong>2）局部感受野与权值共享</strong></p>
<p>卷积神经网络的核心思想就是局部感受野、是权值共享和pooling层，以此来达到简化网络参数并使得网络具有一定程度的位移、尺度、缩放、非线性形变稳定性。</p>
<ul>
<li><p>局部感受野：由于图像的空间联系是局部的，每个神经元不需要对全部的图像做感受，只需要感受局部特征即可，然后在更高层将这些感受得到的不同的局部神经元综合起来就可以得到全局的信息了，这样可以减少连接的数目。</p>
</li>
<li><p>权值共享：不同神经元之间的参数共享可以减少需要求解的参数，使用多种滤波器去卷积图像就会得到多种特征映射。权值共享其实就是对图像用同样的卷积核进行卷积操作，也就意味着第一个隐藏层的所有神经元所能检测到处于图像不同位置的完全相同的特征。其主要的能力就能检测到不同位置的同一类型特征，也就是卷积网络能很好的适应图像的小范围的平移性，即有较好的平移不变性（比如将输入图像的猫的位置移动之后，同样能够检测到猫的图像）</p>
</li>
</ul>
<p><img src="https://img2018.cnblogs.com/blog/1226410/201810/1226410-20181009202559906-1527391226.png" alt="img"></p>
<p><strong>3）卷积层、下采样层、全连接层</strong></p>
<p><strong>卷积层：</strong>因为通过卷积运算我们可以提取出图像的特征，通过卷积运算可以使得原始信号的某些特征增强，并且降低噪声。</p>
<ul>
<li>用一个可训练的滤波器fx去卷积一个输入的图像（第一阶段是输入的图像，后面的阶段就是卷积特征map了），然后加一个偏置bx，得到卷积层Cx。</li>
</ul>
<p><strong>下采样层：</strong>因为对图像进行下采样，可以减少数据处理量同时保留有用信息，采样可以混淆特征的具体位置，因为某个特征找出来之后，它的位置已经不重要了，我们只需要这个特征和其他特征的相对位置，可以应对形变和扭曲带来的同类物体的变化。</p>
<ul>
<li>每邻域四个像素求和变为一个像素，然后通过标量Wx+1加权，再增加偏置bx+1，然后通过一个sigmoid激活函数，产生一个大概缩小四倍的特征映射图Sx+1。</li>
</ul>
<p><strong>全连接层：</strong>采用softmax全连接，得到的激活值即卷积神经网络提取到的图片特征。</p>
<blockquote>
<p><strong>卷积神经网络相比一般神经网络在图像理解中的优点：</strong></p>
<p>网络结构能够较好的适应图像的结构<br>同时进行特征提取和分类，使得特征提取有助于特征分类<br>权值共享可以减少网络的训练参数，使得神经网络结构变得简单，适应性更强</p>
</blockquote>
<p>卷积神经网络（CNN）主要是用于图像识别领域，它指的是一类网络，而不是某一种，其包含很多不同种结构的网络。所有CNN最终都是把一张图片转化为特征向量，特征向量就相当于这张图片的DNA。就像VGG网络一样，通过多层的卷积，池化，全连接，降低图片维度，最后转化成了一个一维向量。这个向量就包含了图片的特征，（这个特征不是肉眼上的图片特征，而是针对于神经网络的特征）</p>
<p><img src="https://static.oschina.net/uploads/space/2018/0314/022939_Pl12_876354.png" alt="022939_Pl12_876354.png"></p>
<p>之所以用VGG举例，因为他的网络结构非常简洁，清晰，相当好理解，简单介绍一下：</p>
<ul>
<li>他的输入是一张224x224 的三通道图片，经过两层卷积之后，图片维度不变，通道数增加到了64。</li>
<li>之后那个红色的层是最大池化（max pooling）把图片维度变成了112x112。后续就是不断重复步骤1，2。</li>
<li>当变成1维向量之后，经过全连接（fully connected）加ReLU激活，softmax处理之后，变成了一个包含1000个数字的特征向量。</li>
</ul>
<p><strong>CNN的工作步骤：卷积，池化，全连接，降低图片维度</strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b9e843b6fa30cd2247c0b91de0cea843.png" alt="img"></p>
<h3 id="CNN的训练过程"><a href="#CNN的训练过程" class="headerlink" title="CNN的训练过程"></a><strong>CNN的训练过程</strong></h3><h4 id="1-卷积神经网络的前向传播过程"><a href="#1-卷积神经网络的前向传播过程" class="headerlink" title="1.卷积神经网络的前向传播过程"></a>1.卷积神经网络的前向传播过程</h4><p>在前向传播过程中，输入的图形数据经过多层卷积层的卷积和池化处理，提出特征向量，将特征向量传入全连接层中，得出分类识别的结果。当输出的结果与我们的期望值相符时，输出结果。</p>
<h5 id="1-1-前向传播中的卷积操作"><a href="#1-1-前向传播中的卷积操作" class="headerlink" title="1.1 前向传播中的卷积操作"></a>1.1 前向传播中的卷积操作</h5><ul>
<li><p>用一个小的权重矩阵去覆盖输入数据，对应位置加权相乘，其和作为结果的一个像素点；</p>
</li>
<li><p>这个权重在输入数据上滑动，形成一张新的矩阵：</p>
</li>
<li><p>这个权重矩阵称为卷积核（convolution kernel）；</p>
</li>
<li><p>其覆盖位置称为感受野（receptive field）；</p>
</li>
</ul>
<p>参数共享；<br>滑动的像素数量叫做步长（stride）:</p>
<p>以卷积核的边还是中心点作为开始&#x2F;结束的依据，决定了卷积的补齐（padding）方式。上面的图片是valid方式（这种方式新的矩阵维度可能会降低），而same方式则会在图像边缘用0补齐（这种方式图像维度不会降低）：</p>
<p>如果输入通道不只一个，那么卷积核是三阶的。所有通道的结果累加：</p>
<p>如图：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/88976ebfb18116b32b7199c8eadd30b0.png" alt="img"></p>
<h5 id="1-2-前向传播中的池化操作"><a href="#1-2-前向传播中的池化操作" class="headerlink" title="1.2 前向传播中的池化操作"></a>1.2 前向传播中的池化操作</h5><p>池化又称为降采样（down_sampling），类型：</p>
<ul>
<li>最大池化（max pooling）：在感受野内取最大值输出；</li>
<li>平均池化（average pooling）：在感受野内取平均值进行输出；</li>
<li>其他如L2池化等。</li>
</ul>
<p>一个选择框，将输入数据某个范围（矩阵）的所有数值进行相应计算，得到一个新的值，作为结果的一个像素点；<br>池化也有步长和补齐的概念，但是很少使用，通常选择框以不重叠的方式，在padding&#x3D;0的输入数据上滑动，生成一张新的特征图：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/59816264cb3c6b633010b44f2c075c36.png" alt="img"></p>
<h5 id="1-3-前向传播中的全连接"><a href="#1-3-前向传播中的全连接" class="headerlink" title="1.3 前向传播中的全连接"></a>1.3 前向传播中的全连接</h5><p>特征图进过卷积层和下采样层的特征提取之后，将提取出来的特征传到全连接层中，通过全连接层，进行分类，获得分类模型，得到最后的结果。</p>
<h3 id="2-卷积神经网络的反向传播过程"><a href="#2-卷积神经网络的反向传播过程" class="headerlink" title="2.卷积神经网络的反向传播过程"></a>2.卷积神经网络的反向传播过程</h3><p>当卷积神经网络输出的结果与我们的期望值不相符时，则进行反向传播过程。求出结果与期望值的误差，再将误差一层一层的返回，计算出每一层的误差，然后进行权值更新。</p>
<h3 id="3-卷积神经网络的权值更新"><a href="#3-卷积神经网络的权值更新" class="headerlink" title="3.卷积神经网络的权值更新"></a>3.卷积神经网络的权值更新</h3><p>卷积层的误差更新过程为：将误差矩阵当做卷积核，卷积输入的特征图，并得到了权值的偏差矩阵，然后与原先的卷积核的权值相加，并得到了更新后的卷积核。</p>
<p><img src="https://i.loli.net/2020/12/19/9lFDuhd5rz3XHqA.png" alt="img"></p>
<p>2和3两个部分过程和神经网络是类似的。</p>
<h2 id="五、实验内容及步骤"><a href="#五、实验内容及步骤" class="headerlink" title="五、实验内容及步骤"></a>五、实验内容及步骤</h2><p><strong>实验背景：</strong></p>
<p>图像识别（Image Recognition）是指利用计算机对图像进行处理、分析和理解，以识别各种不同模式的目标和对像的技术。 </p>
<p>图像识别的发展经历了三个阶段：文字识别、数字图像处理与识别、物体识别。机器学习领域一般将此类识别问题转化为分类问题。</p>
<p>手写识别是常见的图像识别任务。计算机通过手写体图片来识别出图片中的字，与印刷字体不同的是，不同人的手写体风格迥异，大小不一， 造成了计算机对手写识别任务的困难。 </p>
<p>基于AI Studio平台，使用开源的深度学习工具Paddle搭建不同的CNN网络完成同时支持白底黑字和黑底白字的手写数字识别，并对实验结果及性能进行分析。</p>
<p><strong>前置环境准备</strong></p>
<p>安装、导入所需的库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> paddle <span class="keyword">as</span> paddle</span><br><span class="line"><span class="keyword">import</span> paddle.fluid <span class="keyword">as</span> fluid</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br></pre></td></tr></table></figure>



<h3 id="数据集准备"><a href="#数据集准备" class="headerlink" title="数据集准备"></a>数据集准备</h3><h4 id="数据集介绍"><a href="#数据集介绍" class="headerlink" title="数据集介绍"></a>数据集介绍</h4><p>这里的数据集来源是MNIST数据集，包含60000个训练集和10000测试数据集。分为图片和标签，图片是28*28的像素矩阵，标签为0~9共10个数字，每张图片都经过了大小归一化和居中处理。MNIST数据集部分图片批量展示如下：</p>
<p><img src="https://pic2.zhimg.com/80/v2-d39e0fbe06e80995437e17b6033f94dd_720w.jpg" alt="img"></p>
<p>由于需要同时识别白底黑字和黑底白字两种，MNIST数据集为黑底白字，所以这里使用了公开的数据集，这个数据集是在MNIST数据集的基础上加以处理得来的，包含60000个训练集和10000测试数据集，在原有数据集的基础上将黑底白字换成了白底黑字,如下图所示。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAA3klEQVR4nGP8z4AbMOGRo6NkeQec%0A+R8drGZOhTGRdV5lYGBgYOj5r4BF5xyuE//////Az7QVJoIkqct06P///91M9r8wjT1/l4GBgYHh%0ANIPfv18Yrr3yg4GBgeH7ZoZ/XX8x7HwqwjTty49uJiaba1jsDGJikjWQZAp48B+L5JcccSYmRoRb%0AUST/////fzmD/k8EDy341jAGsOEK27+vGBSQ+aimMjG++4/L2DUMRfy4dD7hY9qMzEeRnMrEjWIL%0AirG/GPxRHY+k8IsG2zYUnSxI6n6KhHmiaGSkTaIGAE2/IlTxfxp1AAAAAElFTkSuQmCC" alt="Image"></p>
<p><strong>实验中的数据集是将MNIST数据集(paddle.dataset.mnist.train()导入）和经过处理的白底黑字数据集混合而成的新数据集。</strong></p>
<blockquote>
<p>关于实验中的白底黑子的数字图片数据集(包括训练集与测试集)，我已经上传至个人仓库——<a target="_blank" rel="noopener" href="https://gitee.com/star1111/ailab4_-dl.git">https://gitee.com/star1111/ailab4_-dl.git</a></p>
</blockquote>
<h3 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压白底黑字数据集</span></span><br><span class="line">train_file = zipfile.ZipFile(<span class="string">&quot;/home/aistudio/data/data36874/train.zip&quot;</span>) </span><br><span class="line">train_file.extractall(<span class="string">&quot;/home/aistudio/data/data36874&quot;</span>)</span><br><span class="line"></span><br><span class="line">test_file = zipfile.ZipFile(<span class="string">&quot;/home/aistudio/data/data36874/test.zip&quot;</span>)</span><br><span class="line">test_file.extractall(<span class="string">&quot;/home/aistudio/data/data36874&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 白底黑字训练集标签</span></span><br><span class="line">train_labels_idx1 = <span class="string">&quot;/home/aistudio/data/data36874/train_examples_labels/train-labels.idx1-ubyte&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 白底黑字测试集标签</span></span><br><span class="line">test_labels_idx1 = <span class="string">&quot;/home/aistudio/data/data36874/test_examples_labels/t10k-labels.idx1-ubyte&quot;</span></span><br></pre></td></tr></table></figure>



<h4 id="加载并解析标签"><a href="#加载并解析标签" class="headerlink" title="加载并解析标签"></a>加载并解析标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode_idx1</span>(<span class="params">idx1_ubyte_file</span>):</span><br><span class="line">    <span class="comment"># 读取二进制数据</span></span><br><span class="line">    bin_data = <span class="built_in">open</span>(idx1_ubyte_file, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解析文件头信息</span></span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    fmt_header = <span class="string">&quot;&gt;ii&quot;</span></span><br><span class="line">    magic_number, num_images = struct.unpack_from(fmt_header, bin_data, offset)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解析数据集</span></span><br><span class="line">    offset += struct.calcsize(fmt_header)</span><br><span class="line">    fmt_image = <span class="string">&quot;&gt;B&quot;</span></span><br><span class="line">    labels = np.empty(num_images)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_images):</span><br><span class="line">        labels[i] = struct.unpack_from(fmt_image, bin_data, offset)[<span class="number">0</span>]</span><br><span class="line">        offset += struct.calcsize(fmt_image)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> labels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_label = decode_idx1(train_labels_idx1)</span><br><span class="line">test_label = decode_idx1(test_labels_idx1)</span><br></pre></td></tr></table></figure>



<h4 id="预处理图片并创建-reader"><a href="#预处理图片并创建-reader" class="headerlink" title="预处理图片并创建 reader"></a>预处理图片并创建 reader</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 图片预处理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">image_data_format</span>(<span class="params">file_url</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(file_url).convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    img = img.resize((<span class="number">28</span>, <span class="number">28</span>), Image.ANTIALIAS)</span><br><span class="line">    img = np.array(img).reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>).astype(np.float32)</span><br><span class="line">    img = img / <span class="number">255.0</span> * <span class="number">2.0</span> - <span class="number">1.0</span></span><br><span class="line">    img = img.reshape(<span class="number">28</span> * <span class="number">28</span>)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 data</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_data</span>(<span class="params">dir_name, isTest</span>):</span><br><span class="line">    data = []</span><br><span class="line">    data_urls = []</span><br><span class="line">    data_list = os.listdir(dir_name)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data_list)):</span><br><span class="line">        file_url = os.path.join(dir_name, data_list[i])</span><br><span class="line">        data_urls.append(file_url)</span><br><span class="line">    <span class="keyword">if</span> isTest:</span><br><span class="line">        data_urls.sort(key = <span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[<span class="number">60</span>:-<span class="number">4</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data_urls.sort(key = <span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[<span class="number">62</span>:-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> data_url <span class="keyword">in</span> data_urls:</span><br><span class="line">        <span class="comment"># 将预处理的图片添加到 data list 里</span></span><br><span class="line">        data.append(image_data_format(data_url))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 reader</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_data_reader</span>(<span class="params">data, label</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reader</span>():</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            <span class="keyword">yield</span> data[i], <span class="built_in">int</span>(label[i])</span><br><span class="line">    <span class="keyword">return</span> reader</span><br><span class="line"></span><br><span class="line">train_data_reader = create_data_reader(create_data(<span class="string">&quot;/home/aistudio/data/data36874/train_examples_labels/train_new&quot;</span>, <span class="literal">False</span>), train_label)</span><br><span class="line">test_data_reader = create_data_reader(create_data(<span class="string">&quot;/home/aistudio/data/data36874/test_examples_labels/test_new&quot;</span>, <span class="literal">True</span>), test_label)</span><br></pre></td></tr></table></figure>



<h4 id="数据集混合并随机选择"><a href="#数据集混合并随机选择" class="headerlink" title="数据集混合并随机选择"></a>数据集混合并随机选择</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 缓存区数据数目</span></span><br><span class="line">BUF_SIZE = <span class="number">512</span></span><br><span class="line"><span class="comment"># 每次提取数据数目</span></span><br><span class="line">BATCH_SIZE = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 混合两个数据集</span></span><br><span class="line"><span class="comment"># 每次读取数据集中的 BUF_SIZE 个数据并进行随机</span></span><br><span class="line"><span class="comment"># reader 每次取出 BATCH_SIZE 个数据</span></span><br><span class="line">train_reader = paddle.batch(paddle.reader.shuffle(paddle.reader.chain(paddle.dataset.mnist.train(), train_data_reader), buf_size=BUF_SIZE), batch_size=BATCH_SIZE)</span><br><span class="line">test_reader = paddle.batch(paddle.reader.chain(paddle.dataset.mnist.test(), test_data_reader), batch_size=BATCH_SIZE)</span><br></pre></td></tr></table></figure>

<p>至此，数据集生成完毕，生成的数据集同时包括白底黑字和黑底白字的数据。</p>
<h3 id="网络搭建"><a href="#网络搭建" class="headerlink" title="网络搭建"></a>网络搭建</h3><p>这里使用了两个经典的卷积神经网络，分别是 Lenet-5 和 VGG。</p>
<p>Conv2d参数介绍：</p>
<ul>
<li>in_channels(int) – 输入信号的通道数目</li>
<li>out_channels(int) – 卷积产生的通道数目</li>
<li>filter_size(int or tuple) - 卷积核的尺寸</li>
<li>stride(int or tuple, optional) - 卷积步长</li>
<li>padding(int or tuple, optional) - 输入的每一条边补充0的层数</li>
</ul>
<h4 id="LeNet-5"><a href="#LeNet-5" class="headerlink" title="LeNet-5"></a>LeNet-5</h4><p>LeNet是卷积网络做识别的开山之作，LeNet-5是一个较简单的卷积神经网络。下图显示了其结构：输入的二维图像，先经过两次卷积层到池化层，再经过全连接层，最后使用softmax分类作为输出层。</p>
<p><img src="https://cuijiahua.com/wp-content/uploads/2018/01/dl_3_1.png" alt="网络解析（一）：LeNet-5详解"></p>
<p><strong>LeNet-5网络具体结构：</strong></p>
<p><img src="https://pic2.zhimg.com/v2-308e7517e3f6482a0c376a0d1e90d846_1440w.jpg?source=172ae18b" alt="深度学习|图像分类：LeNet-5"></p>
<p><strong>搭建LeNet-5卷积神经网络代码如下：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 LeNet-5 卷积神经网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lenet_5_net</span>():</span><br><span class="line">    data_type = fluid.layers.data(name=<span class="string">&#x27;image&#x27;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv1 = fluid.layers.conv2d(data_type, <span class="number">6</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">2</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool1 = fluid.layers.pool2d(conv1, <span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv2 = fluid.layers.conv2d(pool1, <span class="number">16</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool2 = fluid.layers.pool2d(conv2, <span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv3 = fluid.layers.conv2d(pool2, <span class="number">120</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    flatten = fluid.layers.flatten(conv3, axis=<span class="number">1</span>)</span><br><span class="line">    fc1 = fluid.layers.fc(flatten, <span class="number">84</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    fc2 = fluid.layers.fc(fc1, <span class="number">10</span>, act=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fc2</span><br></pre></td></tr></table></figure>



<h4 id="VGG"><a href="#VGG" class="headerlink" title="VGG"></a>VGG</h4><p>VGG探索了卷积神经网络深度与其性能之间的关系，通过反复堆叠3*3的小型卷积核和2*2的最大池化层，VGGNet成功地构筑了16~19层深的卷积神经网络。VGGNet相比之前state-of-the-art的网络结构，错误率大幅下降，并取得了ILSVRC 2014比赛分类项目的第二名和定位项目的第一名。同时，VGGNet的扩展性很强，迁移到其他图片数据上的泛化性非常好。VGGNet的结构非常简洁，整个网络都使用同样大小的卷积核尺寸（3*3）和最大池化层（2*2），卷积步长为1，都采用ReLU作为激活函数。</p>
<p><img src="https://static.oschina.net/uploads/space/2018/0314/022939_Pl12_876354.png" alt="022939_Pl12_876354.png"></p>
<p><strong>搭建VGG卷积神经网络代码如下：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 VGG 卷积神经网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vgg_net</span>():</span><br><span class="line">    data_type = fluid.layers.data(name=<span class="string">&#x27;image&#x27;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv1 = fluid.layers.conv2d(data_type, num_filters=<span class="number">128</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">3</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool1 = fluid.layers.pool2d(conv1, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv2 = fluid.layers.conv2d(pool1, num_filters=<span class="number">256</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool2 = fluid.layers.pool2d(conv2, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv3 = fluid.layers.conv2d(pool2, num_filters=<span class="number">768</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool3 = fluid.layers.pool2d(conv3, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv4 = fluid.layers.conv2d(pool3, num_filters=<span class="number">1536</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool4 = fluid.layers.pool2d(conv4, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv5 = fluid.layers.conv2d(pool4, num_filters=<span class="number">1536</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool5 = fluid.layers.pool2d(conv5, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    drop = fluid.layers.dropout(x=pool5, dropout_prob=<span class="number">0.5</span>)</span><br><span class="line">    fc1 = fluid.layers.fc(drop, size=<span class="number">256</span>, act=<span class="literal">None</span>)</span><br><span class="line">    bn = fluid.layers.batch_norm(fc1, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    drop2 = fluid.layers.dropout(x=bn, dropout_prob=<span class="number">0.0</span>)</span><br><span class="line">    fc2 = fluid.layers.fc(drop2, size=<span class="number">256</span>, act=<span class="literal">None</span>)</span><br><span class="line">    fc3 = fluid.layers.fc(fc2, size=<span class="number">10</span>, act=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fc3</span><br></pre></td></tr></table></figure>



<h3 id="训练配置"><a href="#训练配置" class="headerlink" title="训练配置"></a>训练配置</h3><h4 id="训练方式定义"><a href="#训练方式定义" class="headerlink" title="训练方式定义"></a>训练方式定义</h4><p>使用VGG网络+GPU</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前使用的模型</span></span><br><span class="line"><span class="comment"># model = lenet_5_net()</span></span><br><span class="line">model = vgg_net()</span><br><span class="line"><span class="comment"># CPU</span></span><br><span class="line"><span class="comment"># place = fluid.CPUPlace()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GPU</span></span><br><span class="line">place = fluid.CUDAPlace(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h4 id="数据层定义"><a href="#数据层定义" class="headerlink" title="数据层定义"></a>数据层定义</h4><p>输入的图像数据是 28 * 28 的灰度图，灰度图只有一个通道，所以输入的形状是[1, 28, 28]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输入的原始图像数据，大小为 1 * 28 * 28</span></span><br><span class="line">image = fluid.layers.data(name=<span class="string">&quot;image&quot;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&quot;float32&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入图片的标签</span></span><br><span class="line">label = fluid.layers.data(name=<span class="string">&quot;label&quot;</span>, shape=[<span class="number">1</span>], dtype=<span class="string">&quot;int64&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="数据转换"><a href="#数据转换" class="headerlink" title="数据转换"></a>数据转换</h4><p>DataFeeder 负责将数据提供器返回的数据进行转换，方便传入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 告知网络传入的数据分为两部分，第一部分是 image 值，第二部分是 label 值</span></span><br><span class="line">feeder = fluid.DataFeeder(feed_list=[image, label], place=place)</span><br></pre></td></tr></table></figure>

<h4 id="定义损失函数和准确率"><a href="#定义损失函数和准确率" class="headerlink" title="定义损失函数和准确率"></a>定义损失函数和准确率</h4><ul>
<li><p>这里使用的是在分类任务上常见的交叉熵损失函数</p>
</li>
<li><p>同时需要对损失函数定义一个平均值，平均损失作为第一个返回值，被用于反向传播</p>
</li>
<li><p>定义的准确率函数可以方便的输出分类的准确率</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交叉熵损失函数</span></span><br><span class="line">cost_function = fluid.layers.cross_entropy(<span class="built_in">input</span>=model, label=label)</span><br><span class="line"><span class="comment"># 平均损失</span></span><br><span class="line">avg_cost = fluid.layers.mean(cost_function)</span><br><span class="line"><span class="comment"># 计算分类准确率</span></span><br><span class="line">acc = fluid.layers.accuracy(<span class="built_in">input</span>=model, label=label)</span><br></pre></td></tr></table></figure>

<h4 id="定义优化器和学习率"><a href="#定义优化器和学习率" class="headerlink" title="定义优化器和学习率"></a>定义优化器和学习率</h4><p>这里选择了四种优化器和三种学习率</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 学习率</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.0005</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.001</span></span><br><span class="line">LEARNING_RATE = <span class="number">0.0015</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Adam 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.Adam(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># SGD 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.SGD(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># RMSProp 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.RMSProp(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># Adagrad 优化器</span></span><br><span class="line">optimizer = fluid.optimizer.AdagradOptimizer(learning_rate=LEARNING_RATE)</span><br><span class="line"></span><br><span class="line">opts = optimizer.minimize(avg_cost)</span><br></pre></td></tr></table></figure>



<h3 id="模型训练"><a href="#模型训练" class="headerlink" title="模型训练"></a>模型训练</h3><h4 id="参数设置"><a href="#参数设置" class="headerlink" title="参数设置"></a>参数设置</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 迭代轮数</span></span><br><span class="line">EPOCHS = <span class="number">15</span></span><br><span class="line"><span class="comment"># 保存路径</span></span><br><span class="line">save_path = <span class="string">&quot;/home/aistudio/work/hand_inference.model&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">executor = fluid.Executor(place)</span><br><span class="line">executor.run(fluid.default_startup_program())</span><br><span class="line">main_program = fluid.default_main_program()</span><br><span class="line">test_program = fluid.default_main_program().clone(for_test=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">step = <span class="number">0</span></span><br><span class="line">lists = []</span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line">z = []</span><br><span class="line"></span><br><span class="line">predict_output_list = []</span><br><span class="line">answer_output_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> train_time <span class="keyword">in</span> <span class="built_in">range</span>(EPOCHS):</span><br><span class="line">    <span class="keyword">for</span> step_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_reader()):</span><br><span class="line">        metrics = executor.run(main_program, feed=feeder.feed(data), fetch_list=[avg_cost, acc])</span><br><span class="line">        <span class="comment"># 每 200 个打印一次</span></span><br><span class="line">        <span class="keyword">if</span> step % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;==&gt; 训练次数：%d  ==&gt; 训练轮数：%d  ==&gt; 损失：%f&quot;</span> % (step, train_time, metrics[<span class="number">0</span>]))</span><br><span class="line">        step += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证</span></span><br><span class="line">    acc_list = []</span><br><span class="line">    avg_loss_list = []</span><br><span class="line">    <span class="keyword">for</span> test_data <span class="keyword">in</span> test_reader():</span><br><span class="line">        predict_output, acc_np, avg_np = executor.run(program=test_program, feed=feeder.feed(test_data), fetch_list=[model, acc, avg_cost])</span><br><span class="line">        acc_list.append(acc_np)</span><br><span class="line">        avg_loss_list.append(avg_np)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 记录验证时的结果和输出</span></span><br><span class="line">        <span class="keyword">if</span> train_time == EPOCHS - <span class="number">1</span>:</span><br><span class="line">            predict_output_list.append(predict_output)</span><br><span class="line">            answer_output_list.append([<span class="built_in">int</span>(d[<span class="number">1</span>]) <span class="keyword">for</span> d <span class="keyword">in</span> test_data])</span><br><span class="line"></span><br><span class="line">    acc_val_mean = np.array(acc_list).mean()</span><br><span class="line">    avg_loss_mean = np.array(avg_loss_list).mean()</span><br><span class="line">    lists.append((train_time, avg_loss_mean, acc_val_mean))</span><br><span class="line"></span><br><span class="line">    x.append(train_time)</span><br><span class="line">    y.append(acc_val_mean)</span><br><span class="line">    z.append(avg_loss_mean)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印本轮信息</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;======&gt; 第 %d 轮 ======&gt; 平均损失率：%s ======&gt; 平均准确度：%s\n&quot;</span> % (train_time, avg_loss_mean, acc_val_mean))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> save_path <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        fluid.io.save_inference_model(save_path, [<span class="string">&quot;image&quot;</span>], [model], executor, model_filename=<span class="literal">None</span>, params_filename=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">best = <span class="built_in">sorted</span>(lists, key=<span class="keyword">lambda</span> <span class="built_in">list</span>: <span class="built_in">float</span>(<span class="built_in">list</span>[<span class="number">1</span>]))[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;==========&gt; 最好为第 %s 轮数：平均损失率：%s &lt;==========&quot;</span> % (best[<span class="number">0</span>], best[<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;==========&gt; 分类准确度：%.2f%% &lt;==========&quot;</span> % (<span class="built_in">float</span>(best[<span class="number">2</span>]) * <span class="number">100</span>))</span><br></pre></td></tr></table></figure>



<h3 id="模型评估"><a href="#模型评估" class="headerlink" title="模型评估"></a>模型评估</h3><h4 id="计算并绘制准确率与损失图"><a href="#计算并绘制准确率与损失图" class="headerlink" title="计算并绘制准确率与损失图"></a>计算并绘制准确率与损失图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">15</span>, <span class="number">7</span>))</span><br><span class="line">plt.title(<span class="string">&quot;Valid Accuracy and Loss&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Accuracy/Loss&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Epochs&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;g*-&#x27;</span>, linewidth=<span class="number">2</span>,label=<span class="string">&quot;Valid Accuracy&quot;</span>)</span><br><span class="line">plt.plot(x, z, <span class="string">&#x27;b*-&#x27;</span>, linewidth=<span class="number">2</span>,label=<span class="string">&quot;Avg Loss&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> x_label, y_label <span class="keyword">in</span> <span class="built_in">zip</span>(x, y):</span><br><span class="line">    plt.text(x_label, y_label, (<span class="built_in">format</span>(y_label, <span class="string">&quot;.3f&quot;</span>)), ha=<span class="string">&quot;center&quot;</span>, va=<span class="string">&quot;bottom&quot;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> x_label, z_label <span class="keyword">in</span> <span class="built_in">zip</span>(x, z):</span><br><span class="line">    plt.text(x_label, z_label, (<span class="built_in">format</span>(z_label, <span class="string">&quot;.3f&quot;</span>)), ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;准确率与损失图&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="计算并绘制混淆矩阵"><a href="#计算并绘制混淆矩阵" class="headerlink" title="计算并绘制混淆矩阵"></a>计算并绘制混淆矩阵</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">predict_label_list = []</span><br><span class="line">answer_label_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> predict_output <span class="keyword">in</span> np.array(predict_output_list):</span><br><span class="line">    <span class="keyword">for</span> label <span class="keyword">in</span> predict_output:</span><br><span class="line">        predict_label_list.append(np.argsort(label)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> answer_output <span class="keyword">in</span> np.array(answer_output_list):</span><br><span class="line">    <span class="keyword">for</span> label <span class="keyword">in</span> answer_output:</span><br><span class="line">        answer_label_list.append(label)</span><br><span class="line"></span><br><span class="line">sns.<span class="built_in">set</span>()</span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">8</span>, <span class="number">7</span>))</span><br><span class="line">C2 = confusion_matrix(answer_label_list, predict_label_list, labels=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">TX = sns.heatmap(C2, annot=<span class="literal">True</span>, ax=ax, cmap=<span class="string">&quot;YlGnBu&quot;</span>, fmt=<span class="string">&quot;.20g&quot;</span>)</span><br><span class="line">ax.set_title(<span class="string">&quot;Confusion Matrix&quot;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&quot;Predict&quot;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&quot;Test_label&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;混淆矩阵&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="六、实验结果及分析"><a href="#六、实验结果及分析" class="headerlink" title="六、实验结果及分析"></a>六、实验结果及分析</h2><h3 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">W0105 11:51:22.808079   101 device_context.cc:237] Please NOTE: device: 0, CUDA Capability: 70, Driver API Version: 10.1, Runtime API Version: 9.0</span><br><span class="line">W0105 11:51:22.812340   101 device_context.cc:245] device: 0, cuDNN Version: 7.6.</span><br><span class="line">==&gt; 训练次数：0  ==&gt; 训练轮数：0  ==&gt; 损失：2.715984</span><br><span class="line">==&gt; 训练次数：200  ==&gt; 训练轮数：0  ==&gt; 损失：0.099074</span><br><span class="line">==&gt; 训练次数：400  ==&gt; 训练轮数：0  ==&gt; 损失：0.014586</span><br><span class="line">==&gt; 训练次数：600  ==&gt; 训练轮数：0  ==&gt; 损失：0.118899</span><br><span class="line">==&gt; 训练次数：800  ==&gt; 训练轮数：0  ==&gt; 损失：0.027253</span><br><span class="line">======&gt; 第 0 轮 ======&gt; 平均损失率：0.7998331 ======&gt; 平均准确度：0.71556526</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：1000  ==&gt; 训练轮数：1  ==&gt; 损失：0.025513</span><br><span class="line">==&gt; 训练次数：1200  ==&gt; 训练轮数：1  ==&gt; 损失：0.064805</span><br><span class="line">==&gt; 训练次数：1400  ==&gt; 训练轮数：1  ==&gt; 损失：0.010468</span><br><span class="line">==&gt; 训练次数：1600  ==&gt; 训练轮数：1  ==&gt; 损失：0.031004</span><br><span class="line">==&gt; 训练次数：1800  ==&gt; 训练轮数：1  ==&gt; 损失：0.041478</span><br><span class="line">======&gt; 第 1 轮 ======&gt; 平均损失率：0.21556878 ======&gt; 平均准确度：0.9305832</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：2000  ==&gt; 训练轮数：2  ==&gt; 损失：0.006484</span><br><span class="line">==&gt; 训练次数：2200  ==&gt; 训练轮数：2  ==&gt; 损失：0.021212</span><br><span class="line">==&gt; 训练次数：2400  ==&gt; 训练轮数：2  ==&gt; 损失：0.029167</span><br><span class="line">==&gt; 训练次数：2600  ==&gt; 训练轮数：2  ==&gt; 损失：0.029105</span><br><span class="line">==&gt; 训练次数：2800  ==&gt; 训练轮数：2  ==&gt; 损失：0.004107</span><br><span class="line">======&gt; 第 2 轮 ======&gt; 平均损失率：0.29494536 ======&gt; 平均准确度：0.90057725</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：3000  ==&gt; 训练轮数：3  ==&gt; 损失：0.047309</span><br><span class="line">==&gt; 训练次数：3200  ==&gt; 训练轮数：3  ==&gt; 损失：0.007231</span><br><span class="line">==&gt; 训练次数：3400  ==&gt; 训练轮数：3  ==&gt; 损失：0.047308</span><br><span class="line">==&gt; 训练次数：3600  ==&gt; 训练轮数：3  ==&gt; 损失：0.006823</span><br><span class="line">======&gt; 第 3 轮 ======&gt; 平均损失率：0.15273815 ======&gt; 平均准确度：0.955215</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：3800  ==&gt; 训练轮数：4  ==&gt; 损失：0.002544</span><br><span class="line">==&gt; 训练次数：4000  ==&gt; 训练轮数：4  ==&gt; 损失：0.002281</span><br><span class="line">==&gt; 训练次数：4200  ==&gt; 训练轮数：4  ==&gt; 损失：0.026324</span><br><span class="line">==&gt; 训练次数：4400  ==&gt; 训练轮数：4  ==&gt; 损失：0.003007</span><br><span class="line">==&gt; 训练次数：4600  ==&gt; 训练轮数：4  ==&gt; 损失：0.018127</span><br><span class="line">======&gt; 第 4 轮 ======&gt; 平均损失率：0.04622988 ======&gt; 平均准确度：0.9872612</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：4800  ==&gt; 训练轮数：5  ==&gt; 损失：0.015922</span><br><span class="line">==&gt; 训练次数：5000  ==&gt; 训练轮数：5  ==&gt; 损失：0.061257</span><br><span class="line">==&gt; 训练次数：5200  ==&gt; 训练轮数：5  ==&gt; 损失：0.001692</span><br><span class="line">==&gt; 训练次数：5400  ==&gt; 训练轮数：5  ==&gt; 损失：0.002531</span><br><span class="line">==&gt; 训练次数：5600  ==&gt; 训练轮数：5  ==&gt; 损失：0.004477</span><br><span class="line">======&gt; 第 5 轮 ======&gt; 平均损失率：0.050903305 ======&gt; 平均准确度：0.987709</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：5800  ==&gt; 训练轮数：6  ==&gt; 损失：0.003877</span><br><span class="line">==&gt; 训练次数：6000  ==&gt; 训练轮数：6  ==&gt; 损失：0.001130</span><br><span class="line">==&gt; 训练次数：6200  ==&gt; 训练轮数：6  ==&gt; 损失：0.013399</span><br><span class="line">==&gt; 训练次数：6400  ==&gt; 训练轮数：6  ==&gt; 损失：0.002548</span><br><span class="line">======&gt; 第 6 轮 ======&gt; 平均损失率：0.062297203 ======&gt; 平均准确度：0.9832305</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：6600  ==&gt; 训练轮数：7  ==&gt; 损失：0.002033</span><br><span class="line">==&gt; 训练次数：6800  ==&gt; 训练轮数：7  ==&gt; 损失：0.000608</span><br><span class="line">==&gt; 训练次数：7000  ==&gt; 训练轮数：7  ==&gt; 损失：0.003928</span><br><span class="line">==&gt; 训练次数：7200  ==&gt; 训练轮数：7  ==&gt; 损失：0.000658</span><br><span class="line">==&gt; 训练次数：7400  ==&gt; 训练轮数：7  ==&gt; 损失：0.027994</span><br><span class="line">======&gt; 第 7 轮 ======&gt; 平均损失率：0.047455322 ======&gt; 平均准确度：0.98800755</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：7600  ==&gt; 训练轮数：8  ==&gt; 损失：0.000764</span><br><span class="line">==&gt; 训练次数：7800  ==&gt; 训练轮数：8  ==&gt; 损失：0.000986</span><br><span class="line">==&gt; 训练次数：8000  ==&gt; 训练轮数：8  ==&gt; 损失：0.001378</span><br><span class="line">==&gt; 训练次数：8200  ==&gt; 训练轮数：8  ==&gt; 损失：0.001725</span><br><span class="line">==&gt; 训练次数：8400  ==&gt; 训练轮数：8  ==&gt; 损失：0.002057</span><br><span class="line">======&gt; 第 8 轮 ======&gt; 平均损失率：0.03169008 ======&gt; 平均准确度：0.9918392</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：8600  ==&gt; 训练轮数：9  ==&gt; 损失：0.004388</span><br><span class="line">==&gt; 训练次数：8800  ==&gt; 训练轮数：9  ==&gt; 损失：0.000746</span><br><span class="line">==&gt; 训练次数：9000  ==&gt; 训练轮数：9  ==&gt; 损失：0.025454</span><br><span class="line">==&gt; 训练次数：9200  ==&gt; 训练轮数：9  ==&gt; 损失：0.001917</span><br><span class="line">======&gt; 第 9 轮 ======&gt; 平均损失率：0.02877523 ======&gt; 平均准确度：0.99263537</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：9400  ==&gt; 训练轮数：10  ==&gt; 损失：0.000906</span><br><span class="line">==&gt; 训练次数：9600  ==&gt; 训练轮数：10  ==&gt; 损失：0.037665</span><br><span class="line">==&gt; 训练次数：9800  ==&gt; 训练轮数：10  ==&gt; 损失：0.000427</span><br><span class="line">==&gt; 训练次数：10000  ==&gt; 训练轮数：10  ==&gt; 损失：0.010917</span><br><span class="line">==&gt; 训练次数：10200  ==&gt; 训练轮数：10  ==&gt; 损失：0.000988</span><br><span class="line">======&gt; 第 10 轮 ======&gt; 平均损失率：0.027696088 ======&gt; 平均准确度：0.99248606</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：10400  ==&gt; 训练轮数：11  ==&gt; 损失：0.002327</span><br><span class="line">==&gt; 训练次数：10600  ==&gt; 训练轮数：11  ==&gt; 损失：0.001331</span><br><span class="line">==&gt; 训练次数：10800  ==&gt; 训练轮数：11  ==&gt; 损失：0.013818</span><br><span class="line">==&gt; 训练次数：11000  ==&gt; 训练轮数：11  ==&gt; 损失：0.000703</span><br><span class="line">==&gt; 训练次数：11200  ==&gt; 训练轮数：11  ==&gt; 损失：0.002462</span><br><span class="line">======&gt; 第 11 轮 ======&gt; 平均损失率：0.038662598 ======&gt; 平均准确度：0.9909435</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：11400  ==&gt; 训练轮数：12  ==&gt; 损失：0.000980</span><br><span class="line">==&gt; 训练次数：11600  ==&gt; 训练轮数：12  ==&gt; 损失：0.001252</span><br><span class="line">==&gt; 训练次数：11800  ==&gt; 训练轮数：12  ==&gt; 损失：0.002127</span><br><span class="line">==&gt; 训练次数：12000  ==&gt; 训练轮数：12  ==&gt; 损失：0.000286</span><br><span class="line">======&gt; 第 12 轮 ======&gt; 平均损失率：0.03572091 ======&gt; 平均准确度：0.9912918</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：12200  ==&gt; 训练轮数：13  ==&gt; 损失：0.002195</span><br><span class="line">==&gt; 训练次数：12400  ==&gt; 训练轮数：13  ==&gt; 损失：0.000817</span><br><span class="line">==&gt; 训练次数：12600  ==&gt; 训练轮数：13  ==&gt; 损失：0.000664</span><br><span class="line">==&gt; 训练次数：12800  ==&gt; 训练轮数：13  ==&gt; 损失：0.000887</span><br><span class="line">==&gt; 训练次数：13000  ==&gt; 训练轮数：13  ==&gt; 损失：0.005184</span><br><span class="line">======&gt; 第 13 轮 ======&gt; 平均损失率：0.03190916 ======&gt; 平均准确度：0.9924363</span><br><span class="line"></span><br><span class="line">==&gt; 训练次数：13200  ==&gt; 训练轮数：14  ==&gt; 损失：0.000696</span><br><span class="line">==&gt; 训练次数：13400  ==&gt; 训练轮数：14  ==&gt; 损失：0.011965</span><br><span class="line">==&gt; 训练次数：13600  ==&gt; 训练轮数：14  ==&gt; 损失：0.033628</span><br><span class="line">==&gt; 训练次数：13800  ==&gt; 训练轮数：14  ==&gt; 损失：0.000013</span><br><span class="line">==&gt; 训练次数：14000  ==&gt; 训练轮数：14  ==&gt; 损失：0.021946</span><br><span class="line">======&gt; 第 14 轮 ======&gt; 平均损失率：0.03135924 ======&gt; 平均准确度：0.9930832</span><br><span class="line"></span><br><span class="line">==========&gt; 最好为第 10 轮数：平均损失率：0.027696088 &lt;==========</span><br><span class="line">==========&gt; 分类准确度：99.25% &lt;==========</span><br></pre></td></tr></table></figure>

<p><strong>经过15轮VGG网络的训练，分类准确度达到了99.30%，平均损失率为0.03135924(第15个epoch)，取得了优秀的分类结果</strong></p>
<p>部分测试结果展示如下：</p>
<p><img src="https://s2.loli.net/2022/03/01/6G2dDIwrWOqhsH5.png" alt="image-20220103223137510"></p>
<p><img src="https://s2.loli.net/2022/03/01/KAF8dSjTc2JhNIW.png" alt="image-20220104210837690"></p>
<p><img src="https://s2.loli.net/2022/03/01/dZBsnbFwigk78l3.png" alt="image-20220103223229548"></p>
<h3 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h3><p>使用<code>matplotlib.pyplot</code>绘制准确率与损失图，如下所示：</p>
<p><img src="https://s2.loli.net/2022/03/01/SqhQfed1n5LsDBF.png" alt="image-20220105120311113"></p>
<p><strong>可以看到整个数据的训练过程中训练准确率Valid Accuracy逐渐上升，最终趋近100%，训练损失Avg Loss逐渐下降，最终趋近0。整体上训练效果还是比较可观的</strong></p>
<p>使用<code>matplotlib.pyplot</code>绘制混淆矩阵，如下所示：</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeYAAAG/CAYAAACNEnTwAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvIxREBQAAIABJREFUeJzs3Xl8TPf+x/HXTDKRRYggGglip9XWklKkJbG7JA3aqp9Wq5YisbSoUkuCW9stTSzRKlViaauWoKWW2qsorS2XhFhCkUpIMlln5vdHrmGKLDKTOel8nh7zeCTfM/M97zlnxiff7zlzRmUwGAwIIYQQQhHU1g4ghBBCiPukMAshhBAKIoVZCCGEUBApzEIIIYSCSGEWQgghFEQKsxBCCKEgUpiF+J/MzEzee+89mjVrxvDhw5+4n02bNtG/f38zJrOOAQMGsH79emvHEMLmqORzzKK0iYmJYdmyZVy8eBEXFxcaNGjAe++9h6+vb7H63bBhAytXrmTNmjXY29ubKa35HD58mLfeeov27duzYMECY3tsbCxBQUE0b96cFStWFNhPZGQkly5dYs6cOZaMK4R4Qsr730eIfCxbtozPP/+csLAw/Pz80Gg07Nu3j507dxa7MF+7dg0fHx9FFuV73N3dOXHiBMnJyVSoUAGA9evX4+PjY7Z1GAwGDAYDarVMqAlhDfLOE6VGamoqERERTJo0iY4dO+Ls7IxGoyEgIIAPP/wQgOzsbKZPn46fnx9+fn5Mnz6d7OxsIG/E+fLLL7N06VJatmyJn58f69atAyAiIoKFCxfyww8/0KRJE7799lsiIyMZPXq0cf1Xr16lfv365ObmAvD999/Trl07mjRpQkBAAJs2bTK2v/HGG8bH/fbbb/Ts2ZNmzZrRs2dPfvvtN+OyN998k3nz5tG7d2+aNGlC//79uX379mO3gUajoV27dmzduhUAnU7H1q1b6d69u8n9pk2bRps2bWjatCk9evTg6NGjAOzdu5fFixcbn2dgYKAxx9y5c+nduzfPP/88V65c4c033+Tbb78FYPLkyYSGhhr7nz17Nv369UMm3IQwPynMotQ4fvw4WVlZdOjQ4bH3WbRoEb///jsbN25k06ZNnDx5koULFxqXJyUlkZqayt69e5k+fTrh4eHcuXOH4cOHM3jwYLp06cLx48d59dVX882i1WqZNm0aX3zxBcePH2fNmjU0bNjwofulpKQwePBg3nzzTQ4fPsw777zD4MGDSU5ONt5n8+bNfPLJJxw6dIicnByWLl2a77pfeeUVNmzYAMD+/fupV68eVapUMbnPs88+y4YNG/j111/p1q0bI0aMICsri5dfftnked77YwJg48aNTJ06ld9++42qVaua9Ddu3DjOnTvH999/z9GjR/nuu++YOXMmKpUq36xCiKKTwixKjZSUFCpUqJDvVHNMTAzDhg2jYsWKuLu7M2zYMJPiY29vz7Bhw9BoNLRp0wZnZ2cuXrz4RHnUajXnz58nMzMTDw8P6tat+9B9fv75Z2rUqMErr7yCvb093bp1o1atWuzevdt4nx49elCzZk0cHR3p3LkzZ8+ezXe9TZs25c6dO1y4cIENGzYQFBT00H2CgoKM26p///5kZ2cX+DyDg4OpW7cu9vb2aDQak2VOTk7MmjWLGTNmMGbMGCZOnMhTTz2Vb39CiCcjhVmUGm5ubiQnJxunkh/l5s2bJqO9qlWrcvPmTZM+HizsTk5OaLXaImdxdnZm7ty5rFmzBj8/PwYNGkR8fHyBee5lunHjhvH3ypUrFzlPYGAg0dHRHD58+JEzCF9++SVdunShWbNm+Pr6kpqaajJKfxRPT898lz///PN4e3tjMBjo0qVLgRmFEE9GCrMoNZo0aYKDgwM7dux47H08PDy4du2a8ffr16/j4eHxROtzcnIiMzPT+HtSUpLJ8pdeeolly5axf/9+atWqxcSJEwvMcy/T36eeiyooKIhVq1bRpk0bnJycTJYdPXqUJUuWMG/ePI4cOcLRo0dxdXU1Hg9+3PRzQdPS0dHR5OTk4OHhwZIlS4qVXwjxeFKYRanh6urK8OHDCQ8PZ8eOHWRkZJCTk8OePXuYNWsWAP/6179YtGgRt2/f5vbt2yxYsOChE6MKq2HDhhw5coRr166RmprK4sWLjcuSkpLYsWMHWq0WBwcHnJ2dH3kWc5s2bUhISCAmJobc3Fy2bt1KXFwcbdu2faJM91SrVo0VK1YwcuTIh5alp6djZ2eHu7s7ubm5zJ8/n7S0NOPyihUrkpiYiF6vL/T6Ll68yLx585g9ezazZs1iyZIlBU65CyGejBRmUar079+fcePGsXDhQlq2bEnbtm2Jjo6mffv2AAwdOpRGjRoRGBhIYGAgzzzzDEOHDn2idbVu3ZquXbsSGBhIjx498Pf3Ny7T6/V89dVXvPTSSzRv3pwjR44wZcqUh/qoUKECUVFRLFu2jBYtWrBkyRKioqJwd3d/okwP8vX1feTI28/Pj5deeolOnToREBBAmTJlTKapO3fuDECLFi0IDg4ucD25ubmMGTOGgQMH0qBBA3x8fBg1ahRjx441nvEuhDAfucCIEEIIoSAyYhZCCCEURAqzEEIIoSBSmIUQQggFkcIshBBCKIgUZiGEEEJBlPs1Oo9Rr+Uia0cwOneonbUjCCGEldWzSK9O1d8o+E6FlHF5tdn6KgkyYhZCCCEUpNSNmIUQQvzzqVS2O26UwiyEEEJxVDY8oWu7z1wIIYRQIBkxCyGEUByZyhZCCCEUxJYLs+0+cyGEEEKBZMQshBBCcVQqlbUjWI0UZiGEEApkuxO6tvvMhRBCCAWSEbMQQgjFseWTv6QwCyGEUBxbLsy2+8yFEEIIBSr1hblvr0asW9qTU3sGMeNjf5Nlr3ZvyE/f9uH4zgEsmfsvPCo5G5eFvuvL6X2DOL5zgPFWraqrcfm5Q0M4sev+sukftTV79pSUVIYNm07jxr3w9+9PTMzPZl9HYa1cuZkePUbRqFEw48bNtVqOBylp+ygpi+TJX3Z2DuPHR+Dv358mTV4jKGg4e/YctVoeJb23lJSlICrUZruVNqV+KvvmrXQWfXUMvxbVcSxjZ2xv3qQq77/XgjdDNnLpyh0mjPLj0/AO9B260XifrTviGRO287F9B771DZev3rVY9vDwKDQaew4cWMHZsxcYPDicBg1qUrduDYut83E8PNwZOvQ19u07TlZWVomv/1GUtH2UlEXy5C83V4enZyVWrPiEqlUrs2fPUUaOnEVMTCTe3lVKPI+S3ltKylIQmcouAcnJyZw9e5azZ8+SnJxstn6377nIjr0JpNzJNGn396vBj7vjibuYTE6unoXLjtK8SVWqeZUz27qLQ6vNZPv2g4wY0RcXFyd8fZ8hIKA5Gzfutkqejh1b0b59S9zcXAu+cwlQ0vZRUhbJUzBnZ0dCQ/vg7V0FtVqNv39zvL2rcPp0nFXyKOm9paQs4vEsPmK+fPkyEydO5MyZM3h4eABw8+ZNnn76acLCwvDx8bF0BOD+h9Xr1XLnSmLeKDjArwa/bnuHW0laVn53itXrT5s8JnrhK6jVKo6f/JNPPjtI4p+pZsuTkJCInZ2amjW9jG0NGtTkyJFTZltHaaak7aOkLJKn6JKSkklISKROnerWjiKKwJZHzBYvzGPHjqVPnz4sW7YMtTpvQ+v1emJiYvjwww9Zu3atRda775fLzA3vwJr1p0m4eodh/Zuh1xtwdMx7ylt3xrN24xmSbmfw/DMeRP67E3fTstjyU95f1X2GbOD3UzdwdLRn1ODmLJ7TlaB+36DTGcyST6vNpGxZZ5M2V1cX0tMzzNJ/aaek7aOkLJKnaHJychk9+j8EBwdQu3Y1a8cRRWDLhdnizzwlJYXAwEBjUQZQq9UEBQVx584di6334JFEIpYcIfKTTuz+vi+J11NJ12Zz42Y6APEJydxM0qLXGzh+8gZff3OSzv61jY8/euI6Obl6UtOymTb3AN5VXantU8Fs+ZydHUlL05q0paVpcXFxMts6SjMlbR8lZZE8hafX6xk79lM0GnsmTnzPqlmEKAqLF2Y3Nzc2b96MwXB/pGkwGNi0aRPlyln2eG/0utN0fG01rf61nG27L2Bnp+bchb8eeV+DwUB+l2Y1GMCcV2718fFCp9OTkHDN2BYbe1Gm2/5HSdtHSVkkT+EYDAYmTIggKSmFyMiP0GhK/XmuNkdlxn+ljcUL84wZM/j2229p0aIF3bt3p3v37rRo0YLvvvuOGTNmFLt/OzsVDg522NmpsFPf/9nBwY66tdwB8KxSlqnj2vD1Nye5m5oNQLuXfCjn6gDAc0978NZrz7JzXwIAdWpWoGHdiqjVKpyd7Bk3vBU3bqUTn5BS7Lz3ODs70qFDSyIiotFqMzl27Aw7dx4mKMi/4AdbQG6ujqysbPR6PTqdnqysbHJzdVbJAsraPkrKInkKZ/LkhcTHXyUqaiKOjmWslgOU9d5SUpaCqFRqs91KG5XhwaGsBd2+fZvr168D4Onpibu7+xP1U6/lIpPfQ9/1JXTACyZtkUuO8NXaP4he9ArVvcqRrs3h+y2xzF38K3p93tP9NKw9rVtUw0Fjx41baUSvO82Kb08C8GIzL6aMeZmnPFzIyMjl+Mk/mTn/EJeumk69nzvU7omewz0pKamMH/8ZBw+ewM3NlQ8+6Ef37m2L1eeTioxcxfz5q03aQkLeIDS0j1XygLK2j5KySJ78JSbeJCDgXRwcNNjb3/8IZVjYMAIDSz6Tkt5blslSr3ihHsOjwQdm6+tm7H/M1ldJKLHCbC5/L8zWVNzCLIQQpZ9lCnOVhmPM1teNs7PN1ldJkAMvQgghFKc0TkGbi+0+cyGEEEKBZMQshBBCgWx33CiFWQghhOLIVLYQQgghFEFGzEIIIRTHlkfMUpiFEEIoTmn8HmVzkcIshBBCcWx5xGy7z1wIIYRQIBkxCyGEUBxVft8q9A8nhVkIIYTiyFS2EEIIIRRBRsxCCCEUR87KLkWU9I1OTtUnWzuCiYzLYdaOIIQQZiFT2UIIIYRQhFI3YhZCCPHPZ8sjZinMQgghFMeWjzHb7jMXQgghHpCcnMzAgQPp1KkT3bt3JyQkhNu3bwNw4sQJAgMD6dSpE/379+evv/4yPu5Jlz2OFGYhhBDKo1Kb71bYVapUDBgwgG3bthETE0O1atWYM2cOer2eMWPGMGnSJLZt24avry9z5swBeOJl+ZHCLIQQQnFUKrXZbnfv3uXq1asP3e7evWuyTjc3N1q0aGH8vXHjxly7do1Tp05RpkwZfH19Aejduzc//vgjwBMvy48cYxZCCPGPtnz5cubPn/9Qe0hICKGhoY98jF6vZ/Xq1QQEBHD9+nWqVq1qXObu7o5eryclJeWJl7m5uT02rxRmIYQQimPOa2X369eP4ODgh9rLlSv32MdMnToVZ2dn+vbty08//WS2LIUhhVkIIYTimPOs7HLlyuVbhP9u5syZXLp0iaioKNRqNZ6enly7ds24/Pbt26jVatzc3J54WX7kGLMQQgjxP59++imnTp1iwYIFODg4ANCoUSMyMzM5evQoAGvWrKFz587FWpYfGTELIYRQHGtcYOT8+fMsXrwYHx8fevfuDYC3tzcLFixg1qxZTJ48maysLLy8vJg9ezYAarX6iZblR2UwGAyWe5qWcM7aAYzkWtlCCFHPMr02X2i2vs79OtRsfZUEmcoWQgghFESmsoUQQiiPDQ8bbe6pp6SkMmzYdBo37oW/f39iYn42W98ODvYsmjWI/x6M4OaZpfzywyd0bPs8AM2b1GFz9HgS//iCy8cXE71oBE95mJ6Z17iRDz99O4lbZ5eRcCyKYf1NTxIY1r8zZ/d/RlLsMo7vnEOdmk+ZLTtYdtsUVXZ2DuPHR+Dv358mTV4jKGg4e/YctVqelSs306PHKBo1CmbcuLlWy3GPkvaV0vLIvipdeR5LpTLfrZSxuRFzeHgUGo09Bw6s4OzZCwweHE6DBjWpW7dGsfu2t7Pj6vW/6PBaOFcS/6JzQGNWLhyBb8exuJV3Yemqnfy05w9yc3XMnfoOi+e8R9BbMwCoWMGVjV+P48PwFXy/9TAOGnu8PN2Nfb/d259+r/sT/M4sYs8nUrOGBykp6cXO/CBLbpuiys3V4elZiRUrPqFq1crs2XOUkSNnERMTibd3lRLP4+HhztChr7Fv33GysrJKfP1/p6R9pbQ8sq9KVx7xMJsaMWu1mWzffpARI/ri4uKEr+8zBAQ0Z+PG3ebpPyOL6XPXcflqEgaDgR92Hifhyi2aPluL7T//zvdbDpOalkFGZjZRy7fR0vf+SRPDB3Zlx94/WLPhANnZuaSlZ/LfuLzPv6lUKiaM7MnY8K+JPZ8IwMVLN0m+Y77CbOltU1TOzo6EhvbB27sKarUaf//meHtX4fTpOKvk6dixFe3bt8TNzdUq63+Q0vaV0vLIvio9efJlwyNmmyrMCQmJ2NmpqVnTy9jWoEFN4uIuW2R9HpXKU7fmU5w5d/WhZX4tGnL2gfbmTeqSnJLG7u/DuPRbFN8tHU21qhUB8PZ0x7tqRZ6pX43zv8zn7P7P+Pj9Xma9Mk5Jb5uiSkpKJiEhkTp1qls7itUpbV8pLY+SKG3bKC1PvtRmvJUyVo3cvXv3El2fVptJ2bLOJm2uri6kp2eYfV329nYsixjGynV7ORd/zWRZowbV+WhED8b/O9rY5uXpzv/1fJnRU5ZTr2Uol67cYvn8UOMygHYvPYdvx7F06j2V1wJb8XZvf7PlLcltU1Q5ObmMHv0fgoMDqF27mrXjWJ3S9pXS8iiJ0raN0vKIR7P4Mea4uMdPPSYnJ1t69SacnR1JS9OatKWlaXFxcTLrelQqFUvnDSU7O5dRE78yWVarRhU2fv0ho6cs58Cv/zW2Z2Rms2nbEY79cQGA6XPXkfjHF5RzdSIjMweAT6NiuHNXy527Wr6M3kln/8YsW73LLJlLatsUlV6vZ+zYT9Fo7Jk48T2rZlEKpe0rpeVREqVtG6XlyY+hFE5Bm4vFC3O3bt3w8vLiUdcxSUlJsfTqTfj4eKHT6UlIuIaPT943fsTGXjT79GjU7EF4VCrPK/1mkpurM7ZX96rE1lUT+CRiPau/32/ymFOxl3lwEz24vc7FXyMrK8ekzdzXhSmpbVMUBoOBCRMiSEpK4YsvJqPR2Ny5io+ktH2ltDxKorRto7Q8+bLdumz5qWwvLy9WrVrFrl27HrpVrFjR0qs34ezsSIcOLYmIiEarzeTYsTPs3HmYoCDzTQlH/PtdGtTxomf/2WRm5Rjbq1apwA9rPiZq+TaWrNzx0OO+/mYPgZ19ee7pGtjb2/HRiB4c+DWWu6l5J4t9t/kQ7w/pTlkXR7yecqd/nwC27vzNbLlLYtsU1eTJC4mPv0pU1EQcHctYLQfknSWelZWNXq9Hp9OTlZVt8kdXSVLavlJaHtlXpSePeDSLX5Jz5syZdOjQgaZNmz60bNq0aXz88cdF7LF4l+RMSUll/PjPOHjwBG5urnzwQT+6d2/7RH39/ZKc1b0q8d9DkWRmZpOr0xvbQz9aQi2fp5j4fi/S0jNNHlO54TvGnwf2bc+44cE4OTlw8Mh/GTlhKVev3wbAtawTC2YMoHNAE+7c1bJ09S4++ex7k76Ke0lOc26b4kpMvElAwLs4OGiwt7cztoeFDSMwsOQzRUauYv781SZtISFvEBrap8SzgLL2ldLyyL4q6TyWuSRn3bafm62v8z8PMltfJUGulV0Mcq1sIYSwUGH2/8JsfZ3fPdBsfZWEUngiuRBCCPHPJWfTCCGEUB4bPvlLCrMQQgjlUdtuZZapbCGEEEJBZMQshBBCeeQCI0IIIYSC2G5dlqlsIYQQQklkxCyEEEJ5bPjkLynMQgghlMd267JMZQshhBBKIiNmIYQQiiNf+yiEEEIoiQ0fY5apbCGEEEJBZMRcDEr7Niefxt8XfKcSknCih7UjiFLKgLK+8E5ly2chWZMNb3YpzEIIIZTHho8xy1S2EEIIoSAyYhZCCKE8NnzylxRmIYQQymO7dVmmsoUQQgglkRGzEEII5bHhk7+kMAshhFAeGy7MMpUthBBCKIiMmIUQQiiPDQ8bpTALIYRQHhueypbCLIQQQnlsty7b8mSBEEIIoTwyYhZCCKE4BrnylxBCCKEgNnyM2aamsleu3EyPHqNo1CiYcePmWjuOxfM4aOyYObkL+7cO4dSBUWxd+w5tW9cyLm/VvAY71w/k7KEPWP3FG3h5lnuoj/LlHDm2azjfLvu/R65j+KDWJJwYR+sWNcyePyUllWHDptO4cS/8/fsTE/Oz2ddRGNnZOYwfH4G/f3+aNHmNoKDh7Nlz1CpZ7lHKtlFCnpUrN9Ozx/s826gH48bNe+R9FsxfQ4P6gRw8eKLEcoG8dsSTsakRs4eHO0OHvsa+fcfJysqydhyL57GzU3P9Riq9B6wi8fod/P1qM39WEJ1fXUq6Npuo/wQzLvwHdu6J4/1hLzN/ZhDBb60w6WPcyLbEXfwL9SP+hKvu7UbXDvW5cTPV7NkBwsOj0GjsOXBgBWfPXmDw4HAaNKhJ3brm/yMgP7m5Ojw9K7FixSdUrVqZPXuOMnLkLGJiIvH2rlKiWe5RyrZRQh4PD3eGDH2N/ft+IzMr+6Hlly9f58dtB6hc2d3iWf5OXjvFYLsDZtsaMXfs2Ir27Vvi5uZq7SiA5fNkZOYwL2o/V6/dwWCAXfviuZJ4h0YNn6Jzu3qcv5DE1p/+S1a2jnmL9tOwnge1fe7/59X0eS/q167Md5v+eGT/Uz/qyIzPfiYnV2/27FptJtu3H2TEiL64uDjh6/sMAQHN2bhxt9nXVRBnZ0dCQ/vg7V0FtVqNv39zvL2rcPp0XIlnAWVtGyXkyXsfvYib28MzPgDhYVGMHt0PjUPJj0PktVMMapX5bqWMxQtzcnIyEyZMoH///kRHR5ssCw0NtfTqxQMquTtTq4Y75+NvUa92Zc7+96ZxWUZmDpeuplC3dmUA1GoV4eM6MGnGdgyGh/vq2qE+2dk6ft5/wSJZExISsbNTU7Oml7GtQYOaxMVdtsj6iiIpKZmEhETq1KlulfUrbdsoLc+DfvxhPw4OGtq08bV2FEBeO6JwLF6YJ0+eTPny5enduzc7duwgJCSE3NxcAK5cuWLp1Yv/sbdXM+/fgayLOUl8wm2cnTSkpplOn6emZVHWxQGAd/r4cuLkNU6dvfFQXy7ODowJbUPY7B0Wy6vVZlK2rLNJm6urC+npGRZbZ2Hk5OQyevR/CA4OoHbtalbJoLRto7Q896SlaZk7dwXjJwy0ao575LVTRCqV+W6ljMULc0JCAmPHjqVjx44sXbqUypUrM3jwYEUc47UVKhXMndaNnFwdk2b8BIA2I4eyZcuY3K+siwNp6dl4VC7L2280Y/b8vY/sb+R7fqzffJqr1+5YLLOzsyNpaVqTtrQ0LS4uThZbZ0H0ej1jx36KRmPPxInvWS2H0raN0vLcM3/+agID/a12LPdB8tp5Aioz3koZixfmnJwc488qlYrJkydTr149Bg0aJMW5hMya0pVKFV1474P15P7vePC5+Fs0rOdhvI+To4Ya3hU4H3+Lxo088ahUlh3fD+DIjhAmjWnH842qcmRHCGq1itYtavD2G804siOEIztC8KziyoJZr/De2y3MltnHxwudTk9CwjVjW2zsRatNARoMBiZMiCApKYXIyI/QaKx33qTSto3S8tzzy6E/WLEiBr/Wb+HX+i3+vJ7EqJGz+OLzdSWaQ147oqgsXpirVavGkSNHTNo+/PBDnn/+eRISEiy9ehO5uTqysrLR6/XodHqysrLJzdWVaIaSzjN9Qifq1KzIu8O/Iysr19i+bdc56tWuROd29SnjYMeIwa2JPX+T+ITb/Lz/An5dF9H19WV0fX0Zcxft50zsDbq+vgy93kCfQavp1OtL4/Ibt9IYP+1Hvl77m9lyOzs70qFDSyIiotFqMzl27Aw7dx4mKMjfbOsoismTFxIff5WoqIk4OpYp+AEWpLRtY+08995HOr0O/QPvo2VfTSVm83zWb/iM9Rs+w8PDnbCwofT5v64lkuseee08IRs++UtlMDzq1B7zSUlJQaVSUb58+YeWxcXFUadOnSL2eO6Js0RGrmL+/NUmbSEhbxAa2ueJ+ywOc+fxafy9ye9enuU48MNQsrJyydXdP3N6/LQf2bj1DK1b1CB8XEe8PMtx4tR1Rk/a8sjp6V6Bz/J68HO8+k70Q8sA9m8dwodhWzlw+JKxLeFEjyd6Dg9KSUll/PjPOHjwBG5urnzwQT+6d29b7H6LKjHxJgEB7+LgoMHe3s7YHhY2jMDAks8Dytk2lshjoGj/JUVGrmLB/DUmbcNCej/0PgoIGMC0aSG0atW4SP2rijEXahuvnXrmimai9rvfmq2v+C9fNVtfJcHihdn8nrww/9P9vTBbkzkKs7BNRS3MllacwmwbpDCbm01dYEQIIUTpYLDhv4ekMAshhFCeUnhs2Fxs6spfQgghhNLJiFkIIYTylMILg5iLFGYhhBDKI1PZQgghhFACGTELIYRQHhseNkphFkIIoTw2fIzZhv8mEUIIIZRHRsxCCCGUx4ZP/pLCLIQQQnEMMpUthBBCCCWQEbMQQgjlseFhoxTmfxAlfaNT7WZbrR3BRPyxkv0O3oLINyg9npKyCCuy4WPMNvw3iRACpBAKoTQyYhZCCKE8NnzylxRmIYQQyiNT2UIIIYRQAhkxCyGEUB7bHTBLYRZCCKE8BpnKFkIIIYQSyIhZCCGE8tjwiFkKsxBCCOWx4Y9LyVS2EEIIoSAyYhZCCKE8NjxstOGnLoQQQrFUKvPdimDmzJkEBARQv359zp07Z2wPCAigc+fOBAUFERQUxL59+4zLTpw4QWBgIJ06daJ///789ddfhVr2OFKYhRBCiP9p164d0dHReHl5PbQsIiKCjRs3snHjRl566SUA9Ho9Y8aMYdKkSWzbtg1fX1/mzJlT4LL8SGEWQgihPGqV2W53797l6tWrD93u3r370Gp9fX3x9PQsdMxTp05RpkwZfH19Aejduzc//vhjgcvyfeqFXvs/REqrJoY9AAAgAElEQVRKKsOGTadx4174+/cnJuZnq2VZuXIzPXqMolGjYMaNm2u1HCWVxUFjxycT27N3c39+3zuUmFX/R5tWPsblrV6oxvZ1b3HqwDCiF/ek6lOuJo+dMakDJ/YM4ZdtA+n/f00euY6QgS2IPzaSVs2rmTW7tV83K1dupmeP93m2UQ/GjZtnbM/OzmH48BkEBAygQf1ADh8+WaK57rH29nlQdnYO48dH4O/fnyZNXiMoaDh79hy1Wh4lvc9BWfsqX2YszMuXL6ddu3YP3ZYvX16kSKNHj6Z79+5MmTLFWNSvX79O1apVjfdxd3dHr9eTkpKS77L82NzJX+HhUWg09hw4sIKzZy8weHA4DRrUpG7dGiWexcPDnaFDX2PfvuNkZWWV+PpLOoudnYrrN9J4Y+B3XPvzLm39ahIxoytdX1+JNiObhXO68dHUHezce4H3h7QkYkZXer29FoDhg1/Ep7obL3dbSuWKzkQv7kXchdvsPXTJ2H917/J0bV+XG7fSzJ7d2q8bDw93hgx9jf37fiMzK9tkWbOmDen3ViAjR84skSyPYu3t86DcXB2enpVYseITqlatzJ49Rxk5chYxMZF4e1cp8TxKep+DsvZVSenXrx/BwcEPtZcrV67QfURHR+Pp6Ul2djbTp08nPDy8UNPST8IqI+Y7d+5YY7VotZls336QESP64uLihK/vMwQENGfjxt1WydOxYyvat2+Jm5trwXf+B2TJyMwl4vNfSLx+F4MBdu+7yNVrd2jU0INO/nU4H/8XP+w4T3a2js8W/0LDupWp5VMBgB7dGjJ/yWHupmYRn5DM2g2n6Nn9aZP+wz70Z1bEfnJy9GbNrYTXTd7+eRE3N9P/SBwcNPR7O4hmvk+jVltnAkwJ2+dBzs6OhIb2wdu7Cmq1Gn//5nh7V+H06Tir5FHS+1xp+yo/BpXKbLdy5crh7e390K0ohfne9LaDgwN9+vTht99+M7Zfu3bNeL/bt2+jVqtxc3PLd1l+LP5Ojo2NpUePHvTq1Yv4+HgGDRrEyy+/TJs2bTh79qylV28iISEROzs1NWveP6jfoEFN4uIul2gOkaeiuzM1q1fg/IW/qFu7ImfPJxmXZWTmcvlqCnVrVaScaxmqVC7L2XP3l589d4u6tSsaf+/Svi5Z2Tp+PpBg9pzyusmf0rdPUlIyCQmJ1KlT3dpRrE7p+8qE2oy3YtJqtaSmpgJgMBjYunUrDRs2BKBRo0ZkZmZy9Gje4ZI1a9bQuXPnApflx+JT2dOmTWPYsGGkpqYyYMAARo0axeeff86uXbuYOXMmX331laUjGGm1mZQt62zS5urqQnp6RollEHns7dXMndaZ7zef5UJCMs5OGm6nmO6H1LRsyro44OKs+d/vWSbLXJwdAHBx1jB6WCveGrreIlnldZM/JW+fnJxcRo/+D8HBAdSubd7zDkojJe8rpZg2bRrbt28nKSmJd955Bzc3N6KioggNDUWn06HX66lduzaTJ08GQK1WM2vWLCZPnkxWVhZeXl7Mnj27wGX5sXhhTk9Pp127dgB89tlnBAYGAnmfCYuIiLD06k04OzuSlqY1aUtL0+Li4lSiOWydSgX/Ce9ETo6OKbPyptC0GTmUdXEwuV/Zsg6kpWeTrs0BwNXFgb+y8/4DKeviQLo271jr8MEvsn5rLInXHz7D0hzkdZM/pW4fvV7P2LGfotHYM3Hie1bNohRK3VePZKVLcn788cd8/PHHD7Vv2LDhsY9p2rQpMTExRV72OBafyjYYDMafW7dubbJMrzfvscCC+Ph4odPpSUi4P+cfG3tRprhK2IxJHahU0ZmhYzeTm5v3Gjgf/xcN61Y23sfJ0Z7q3uU5f+Ev7qZmceNWGg3q3V/esF4lzsfnfVC/1QvV6de7Mb9sG8gv2wbiWaUskTP+xaB+vmbJK6+b/Clx+xgMBiZMiCApKYXIyI/QaGzuPNdHUuK+eiwznpVd2li8MHt5eZGWlneW7LRp04ztf/75J05OJftXmrOzIx06tCQiIhqtNpNjx86wc+dhgoL8SzTHPbm5OrKystHr9eh0erKyssnN1f2js0z9KIDaNd0ZOHITWVn3+9++O556dSrSKaAODg52hA58kdjzSVxISAZg/ZazDHu3OeVcy1DLpwKvBz/LupgzALw5ZB1dXltBtz7RdOsTzc1b6Xz8752s/OZ3s2RWwuvm3v7R6XXo/7Z/srNzyPrfmdo5OblkZWWb/EFsaUrYPn83efJC4uOvEhU1EUfHMlbLAcp6nytxX4mHqQwl+Q5+gFarJSMjg4oVKxZ8ZxPnCr5LPlJSUhk//jMOHjyBm5srH3zQj+7d2xarzycVGbmK+fNXm7SFhLxBaGifUp+ldrOtD7VVfcqVfVveJSsrl1zd/dmSj/+9k00//JdWzasx5UN/vJ4qx4lTfzJ2ynbj9LSDxo7wjwLo3K4OWVm5LF5+lKXRxx+57j0x/flo6k8c/PWKsS3+WNcneh73mPt1Y6Bob7vIyFUsmL/GpG1YSG9CQ/sQEDCAa4k3TZbt2PlFoT8apKL4Iwolva8SE28SEPAuDg4a7O3tjO1hYcMIDCz5TEp6n4Ml9lU9c0UzUWP2LrP1dWlMgNn6KglWK8xPrniFWZSMRxVmaypuYTa3ohZmSzJHYRa2zEKFeY4ZC/Po0lWYbe7KX0IIIYSSyRkRQgghFMdQCk/aMhcpzEIIIZTHSh+XUgIpzEIIIZTHhkfMcoxZCCGEUBAZMQshhFAe2x0wS2EWQgihPFb6sjRFsOGnLoQQQiiPjJiFEEIojg2flC2FWQghhPLYcmGWqWwhhBBCQWTELIQQQnFUNjxklsIshBBCcWy4LkthFpahtG9zqtdyp7UjmDh3qJ21I4hSSknfTAY2/XFji5HCLIQQQnFkxCyEEEIoiMqGT0224acuhBBCKI+MmIUQQiiOTGULIYQQCmLD3/ooU9lCCCGEksiIWQghhOLIVLYQQgihILZcmGUqWwghhFAQGTELIYRQHLlW9mM888wz+W4cg8GASqXi1KlTZg8mhBDCdtnyBUbyLcwxMTEllUMIIYQQFFCYa9Wq9cj2lJQU3NzcLBJICCGEsOGZ7MKf/JWWlsZHH31E48aNadu2LQC7d+9mwYIFlsomhBDCRqlU5ruVNoUuzGFhYUDe9LZGowHgueeeY9OmTZZJZiEpKakMGzadxo174e/fn5iYnyWLjebp26sR65b25NSeQcz42N9k2avdG/LTt304vnMAS+b+C49KzsZloe/6cnrfII7vHGC8VavqCkCF8o6sXvwKh398h6Pb+7P282CaPveUWXOD7e2r0pxn5crN9OgxikaNghk3bq5V1t+zx/s826gH48bNM1l26NDvdOk8hMbP9+KtNyeQmHizxPOJhxX6rOz9+/ezZ88eHBwcjCeEVaxYkaSkJIuFs4Tw8Cg0GnsOHFjB2bMXGDw4nAYNalK3bg2bzmKLeW7eSmfRV8fwa1EdxzJ2xvbmTary/nsteDNkI5eu3GHCKD8+De9A36EbjffZuiOeMWEPf8dzekYO46f/TMKVFAwGaP+yD1Gzu9Cy61fodOb7Hl1b21elOY+HhztDh77Gvn3HycrKssr6hwx9jf37fiMzK9vYnnz7LqEhnzBtWgj+Ac35bF4074+axdpv5pR4xkcpjSNdcyn0iNnFxYW7d++atP35559UqlSpyCs9ePBgkR9jDlptJtu3H2TEiL64uDjh6/sMAQHN2bhxt01nsdU82/dcZMfeBFLuZJq0+/vV4Mfd8cRdTCYnV8/CZUdp3qQq1bzKFdhndraOi5fzirJKBTq9AbdyjpQv52i23La4r0pzno4dW9G+fUvc3FytuP4XcXMzff1u/+kgdepWp3MXP8qUcSAk9A1iYxO4EH/VKjn/Tq0y3620KXRhDg4OZuTIkRw/fhyDwcCZM2cYP348r776ar6Pi4uLe+j20UcfER8fT1xcXLGfQFEkJCRiZ6emZk0vY1uDBjWJi7tcojmUlkXy5O/eDFG9Wu7GtgC/Gvy67R22RL/OG8HPPPSYTSte4+SeQSye3ZVvNp7hdnKG2fIoadtIntIr7vwVGtT3Mf7u7OxI9epPcV62k9UVeip7yJAhaDQaRo8ejVarJSQkhN69e/Puu+/m+7hu3brh5eWFwXB/Gi8pKYmBAweiUqnYufPh6UBL0WozKVvW2aTN1dWF9HTz/adZGrNIHlP7frnM3PAOrFl/moSrdxjWvxl6vQFHx7y3y9ad8azdeIak2xk8/4wHkf/uxN20LLb8dP8PzcA3v8HBwY4ObWrioLF73KqeiOyr0pVHqbTaDNzdy5u0lS3rrJjtZMtT2YUuzGq1mkGDBjFo0KAirSAkJITff/+dsLAwqlatCkBAQAC7du0qWlIzcHZ2JC1Na9KWlqbFxcXJprNIHlMHjyQSseQIkZ90oqyLA8vX/kG6NpsbN9MBiE9INt73+MkbfP3NSTr71zYpzJA3rb3lpzh+WN2bs+eSiI37yyz5ZF+VrjxK5ezs9PB2Ss9QzHay5cJcpGur/Pbbb0ydOpXQ0FCmTp3KsWPHCnxMSEgIo0aN4v3332f16tWA9S615uPjhU6nJyHhmrEtNvYidepUt+kskudh0etO0/G11bT613K27b6AnZ2acxceXVjzroD3+L7s7dWFOj5dWNbeNpLnn6FO3WrExl40/q7VZnLl8nXqynayukIX5pUrVzJkyBBUKhVNmzZFrVYzdOhQVqxYUeBjn376ab7++msSExN5++23ycnJKVboJ+Xs7EiHDi2JiIhGq83k2LEz7Nx5mKAg/4If/A/OYqt57OxUODjYYWenwk59/2cHBzvq/u94smeVskwd14avvznJ3dS8M1rbveRDOVcHAJ572oO3XnuWnfsSAHj+mSo0e+4pNPZqypSxY2DfxlSs4MTvp2+YLbct7qvSnCc3V0dWVjZ6vR6dTk9WVja5uboSX79Or0P/wPo7dGjJ+fOX2bbtIFlZ2SxcsIb69X2oVdu7xLLlR6VWme1W2qgMDx78zcfLL7/M4sWLadiwobEtNjaWgQMHsm/fvkKv8MSJE/z6669FnhK/79wTPi5PSkoq48d/xsGDJ3Bzc+WDD/rRvXvbYvX5T8jyT89Tr+XD5zKEvutL6IAXTNoilxzhq7V/EL3oFap7lSNdm8P3W2KZu/hX9Pq8t8qnYe1p3aIaDho7btxKI3rdaVZ8exKAF5p4MnGUH95Vy5Gr03Mu/jbzPv+Voyeum6zn3KF2T/Q87vkn76t/Wp7IyFXMn7/apC0k5A1CQ/s8UX8Givaxu8jIVSyYv8akbVhIb0JD+3Dw4Ammhi/m2rVbPPd8PT75ZATe3lWK1L+K+kW6f2E1/3a/2fr69VU/s/VVEgpdmP38/Ni1axcODg7GtqysLNq1a8f+/ebbgAUrXmEWtulRhdmailuYhe0qamG2NCnM5lfoqeyQkBAmT57M9evXMRgMXLt2jbCwMEJDQy2ZTwghhA2y5UtyFvprHw0GAzqdjg0bNhiXGwwGNm3axOuvv27ZlEIIIWxKaSyo5iJf+yiEEEIoyBN97aMQQghhSaXwZGqzKfQFRiDviyyOHDlCcnKyyZW8pk6davZgQgghbJctT2UX+uSvxYsX88EHH5CSksLGjRtRq9Vs374dOzvzXm5QCCGEsGWFLsxr167lq6++IiwsDI1GQ1hYGIsWLSp1X/sohBBC+VRq891Km0JHvnPnjvHiIhqNhpycHJo2bcqhQ4csFk4IIYRtko9LFYK3tzfx8fHUrl2bOnXqsG7dOsqXL4+rq3W+Y1QIIYT4Jyp0YQ4NDeXWrVvUrl2bkSNHMmrUKDIyMggLC7NkPiGEEDbIWl92pASFLszt27c3/tysWTP27t1rkUBCCCGEDdfl/AvzjRuF+0acKlWKdtFzIYQQQjxavoW5TZs2qFQq8vueC5VKxdmzZ80eTAghhO2SEfNj/PHHHyWVQwghhDCSwvwYD37FY2G0bNlSPj4lFElpX7NYp+ev1o5gFLeuubUjiCJQYcMVy0YU6ZKcBcnMzDRnd0IIIWyUXCvbTGz59HYhhBDmY8uFuRRerEwIIYT45zLriFkIIYQwB7Xq8Z8G+qcza2HO72NVQgghRGHJVHYhzJw585Htc+bMMf68cOHC4icSQghh89RmvJU2Rfrax0f59ttvjT+3bNmy+ImEEEIIG1bgVHZMTAwAOp2OzZs3m0xXX7lyhfLly1sunRBCCJskx5jzsXLlSgBycnJYsWKFsV2lUlGxYkWmT59uuXRCCCFski0fYy6wMN+bwp45cyYffvihxQMJIYQQtqzQZ2UPHTqUzMxMHB0dMRgMbNmyBbVaTdeuXS2ZTwghhA0qjSdtmUuhn/uAAQOIi4sDYN68eURGRjJ//nxmzZplsXBCCCFsk1plvltpU+jCfOHCBZ5++mkANm7cyJdffsnKlSvZtGmTxcIJIYQQtqbQU9lqtZrc3FwuXbqEk5MT3t7eGAwG0tPTLZnPrLKzc5gyZRGHDp0gJSWN6tWf4v3336JNG1+r5ElJSWXChAgOHDhOhQrleP/9t+jeva1Vsigtj63tqze71KNH29rUr+FGzP4EPpyf9y1tgS/5MHVwC+P91GoVTmXsCRqzldMXbvPlBH98G3oYl2vs1Vy8dpd/vb8FgIY+FZj07gs0qOFGemYOq7fHseC7k2bLDcrbV6Cs17KSsigxz+Oo5KzsgrVu3ZoxY8Zw+/ZtunTpAuSNoj08PAp4pHLk5urw9KzEihWfULVqZfbsOcrIkbOIiYnE27tKiecJD49Co7HnwIEVnD17gcGDw2nQoCZ169Yo8SxKy2Nr++rG7QwWrDvJS42r4uhgZ2zftC+BTfsSjL/38K9FSK9nOX3hNgDvTt9t0k90WAcOnfrT+Pvcka3Z/usV/m/yT3hXdmHN9E7EJiSz8+hVs+QG5e0rUNZrWUlZlJjncUrjFLS5FHoqe/r06TRr1owuXbrw3nvvAXDz5k2GDBlisXDm5uzsSGhoH7y9q6BWq/H3b463dxVOn44r8SxabSbbtx9kxIi+uLg44ev7DAEBzdm4cXfBD7aBPLa2r7YfvsKOX6+SkpqV7/16tK3F+p8vPHKZV2UXfBtWNlnu5VGWTXsT0OsNXL6RxrGzN6lbzbzXHlDSvgJlvZaVlEWJecSjFbowOzk58dZbb9GnTx+0Wi2Qd6WvV155Jd/HHThwwPhzamoqY8aMoX379oSGhpKUlPSEsc0jKSmZhIRE6tSpXuLrTkhIxM5OTc2aXsa2Bg1qEhd3ucSzKDHP38m+gqqVXXihoQfr9zy6MAe3rcXRs7dIvHX/8NJXm2MJblsTezsVNauWo0n9Shz4489HPt5crLmvQDn7S2lZlJgnP3JJzkJIS0tj/PjxNG7cmLZt2wKwe/duFixYkO/jHryW9ty5c3FxcWHhwoXUqlWLadOmPVlqM8jJyWX06P8QHBxA7drVSnz9Wm0mZcs6m7S5urqQnp5R4lmUmOdBsq/yBLfJK7xXbz76vI7gNrVY93O8SduuY1fp/GINTq1+g58iA/l2Zzwn4/+yWEZr7ytQzv5SWhYl5smPWmUw2620KXRhDgsLw2AwEBMTg0ajAeC5554r8KzsBy/heezYMSZMmEC9evUYNWoU8fHx+TzScvR6PWPHfopGY8/Eie9ZJYOzsyNpaVqTtrQ0LS4uTpLnAbKv7gtuW5Pvf370e6ZZg8pUcnPkx0P3Rz7lyzqw7OMAIr/9g2d6r8Zv4Pe81NiT/+tUzyL5lLCvQDn7S2lZlJhHiWbOnElAQAD169fn3LlzxvaLFy/y+uuv06lTJ15//XUSEhKKvexxCl2Y9+/fT1hYGNWqVUOlyjsqX7FixQKno7Ozs4mPjycuLg6VSmUs6pB3pndJMxgMTJgQQVJSCpGRH6HRWOcrqX18vNDp9CQkXDO2xcZetNr0n9LygOyrBzWtXxmPCs4mhfdBPdrWYvvhK2gzc41t1aqURac3sGHPRXR6A3/e1rJ5/yXaNK1q9nxK2VegjP2lxCxKzJMfa32OuV27dkRHR+Pl5WXSPnnyZPr06cO2bdvo06cPkyZNKvayxz73woZ1cXHh7t27Jm1//vknlSpVyvdxmZmZDBo0iEGDBnH37l1u3LgB5E2NW6MwT568kPj4q0RFTcTRsUyJr/8eZ2dHOnRoSURENFptJseOnWHnzsMEBflLnv+xpX1lp1bhoFFjp1aZ/HxPD/9abPvlMukPFN57yjjY0bVVDdbtNh1NJ1xLRaVS0d3PB5UKKrk58q/WNfjvpRSz5b5HKfsKlPVaVlIWJebJjzmPMd+9e5erV68+dPt7TQPw9fXF09PTpO2vv/7izJkzdOvWDYBu3bpx5swZbt++/cTL8lPoP2uDg4MZOXIkH3zwAQaDgTNnzjBnzhxeffXVfB+3a9euR7bb2dkRERFR2NWbRWLiTdau/REHBw1+fm8Z28PChhEY2LZEswBMnjyE8eM/o1Wrvri5uTJlyhCrfmRBSXlsbV8N6/Usw19/zvj7K21qEbH2DyK++QMHjZqurWowbPbeRz62Q/Nq3NVm88upGybtaRk5DJ21h7FvNiV8UHMys3XsOnrV7J9jVtq+AmW9lpWURYl5SsLy5cuZP3/+Q+0hISGEhoYW+Pjr169TpUoV7OzyPspoZ2eHh4cH169fx2AwPNEyd3f3x65PZXjwIHA+9Ho9S5YsYe3atfz5559UqVKF3r17M3DgQOPUdsk4V/BdhFC4Oj1/tXYEo7h1za0dQZRqljln4e29e8zWV0TjJo8cHZcrV45y5co98jEBAQFERUVRr149Tp06xYcffsiWLVuMy7t27crs2bMxGAxPtOyZZ555bN4CR8ybN2+mW7duqNVq45S0EEIIYUnmPJs6vwJcGJ6enty4cQOdToednR06nY6bN2/i6emJwWB4omX5KfAgb2EOVAshhBD/VBUrVqRhw4Zs3rwZyBuwNmzYEHd39ydelp8Cp7KbNGnC8ePHzfHczESmskXpJ1PZ4p/DMlPZA/b/bLa+lvi1LfR9p02bxvbt20lKSqJChQq4ubmxZcsW4uPjGTduHHfv3qVcuXLMnDmTWrVqATzxsscpsDA///zzLF68mPzu1rJly0I/6eKTwixKPynM4p/DMoV5kBkL8+dFKMxKUOAx5uzsbCZMmPDYwqxSqdi5c6fZgwkhhBC2qMDC7OTkJIVXCCFEiSqNl9I0F+tdnkcIIYR4DPnax3wU8mPOQgghhDCDAkfMyjojWwghhC2w5RGzTGULIYRQnNL4PcrmYsvPXQghhFAcGTELIYRQHDkrWwghhFAQWz7GLFPZQgghhILIiFkIKzi/7gVrRzCqG2C+r9czh/O72lg7glAAWx41SmEWQgihODKVLYQQQghFkBGzEEIIxVHJWdlCCCGEcshUthBCCCEUQUbMQgghFMeWR41SmIUQQiiOLV/5y5b/KBFCCCEUR0bMQgghFMeWT/6SwiyEEEJxbLkwy1S2EEIIoSAyYhZCCKE4dtYOYEVSmIUQQiiOnJVtQ65evcHAgVN44YXetG79JuHhUeTm6qyaKSHhGs8+24PRo/9j1RwpKakMGzadxo174e/fn5iYnyWPQrKsXLmZnj3e59lGPRg3bp7JskOHfqdL5yE0fr4Xb705gcTEm8VeX99Xnub7Ra9w+sf+zBxr+m1PXdrU4sdlvTi+uR8/LO1F+9Y1jMscNGrGD32R/d/04ejGt5gyojX2dirjsn+PfpmfV/fm+OZ+bPq8By839y521kex9v66Jzs7h/HjI/D370+TJq8RFDScPXuOWiXLPUrZNuLxbK4wh4UtomLF8uzf/zUbNkRw5MgpVq3aYtVM4eGLePbZulbNkJcjCo3GngMHVjB79gdMmbKI8+cvSR4FZPHwcGfI0Nfo2bO9SXvy7buEhnzCiBH/x+FfV9GoUR3eHzWr2Ou7+ZeWhSuP892P/zVpr1LJmTnj2/LvRb/QpNtyZi4+zKcTAnB3cwRg0BuNaVSvMv96dx0d3/qGZ+pWZGjfJgDY2am5fiuN/xu5mabdlzN36VE+m9QOrypli53376y9v+7JzdXh6VmJFSs+4dixNYwc2ZeRI2dx9eqNEs9yj1K2TUHUKvPdShubK8xXr96gS5eXKFPGgcqVK+Dn15S4uMtWy7Nly15cXV1o2fJ5q2UA0Goz2b79ICNG9MXFxQlf32cICGjOxo27bT6PErJ07NiK9u1fxM2tnEn79p8OUqdudTp38aNMGQdCQt8gNjaBC/FXi7W+7fsS2HHgEil3s0zan6rkQmpaNnt/zev/58NXyMjMoXrVvFwBLavz9fpT3EnN4vadTL7+/jS9utQHICMzl8jlv5F4Iw2DAXb/cpmr11NpVK9SsbL+nRL21z3Ozo6EhvbB27sKarUaf//meHtX4fTpuBLPAsraNgWRwlyC0tPTOX36NGlpaSW9agD69Qtky5a9ZGRkcuPGX+zbd4yXXmpmlSxpaVoiIqL56KMBVln/gxISErGzU1OzppexrUGDmlb7o0VJeZSU5e/izl+hQX0f4+/Ozo5Ur/4U5y2U7eS5JOIvpxDQqjpqtYr2rWuQnaPjvxduG++j4v7/hCoVeHqUpayL5qG+KlZwoma18pxPSDZrRiXvr6SkZBISEqlTp7pV1q/kbSPus/jJX5MmTWLkyJG4u7tz7NgxQkNDqVChArdv32b27Nn4+flZOoKJF15oxDffbKNZs9fR6fQEBwfQvv2LJZrhnnnzVtKzZweeesq8I4YnodVmUrass0mbq6sL6ekZNp9HSVn+TqvNwN29vElb2bLOFsum1xtYv/08n04IoIyDHTk5eoaH7SAjMxeAfUeu0q/nMxw+cQ21WsVbPRoB4FTGnrT0HGM/9nYq/jPen/XbznPhyh2zZlJO3mwAACAASURBVFTq/srJyWX06P8QHBxA7drVrJJBqdvmUexK4UjXXCw+Yj5x4gTu7u4AfPbZZ0RFRbFlyxZWrVrFp59+aunVm9Dr9QwYMJkOHVpy4sR3/PJLNHfupDN79lclmgPg7NkLHDp0grffDirxdT+Ks7MjaWlak7a0NC0uLk42n0dJWf7O2dnp4WzpGRbL1qppVcYOak7fUZt5uuOX/N+oGKaPfpmGtfPe4wtXHudM3F9s/KIH30QG8tP+BLJzdCQl3/+PX6WC2R/5k5OrIyzigNkzKnF/6fV6xo79FI3GnokT37NaDiVum8eRqWwLysq6f4wqPT2d5557DoCaNWuSk5PzuIdZREpKKteu3aJv3244OGioUKEcPXu2Y+/ekj9L8vDhkyQm3sTfvz+tW7/J0qXr2b79IMHBI0o8C4CPjxc6nZ6EhGvGttjYi1abclNSHiVl+bs6dasRG3vR+LtWm8mVy9epa6FsDetU5MjJPzl1LgmDAU7+N4nfz96kVbO8qdGsbB3hEQd56bVVBPRdS8rdLE7/7773fDLmZSpVcCJk8g5ydeb/SIzS9pfBYGDChAiSklKIjPwIjcZ6n1JV2rYRj2bxwtyyZUtmzJhBRkYGLVq0YOvWrQAcOHAANzc3S6/ehLt7eby9q7B69VZyc3XcvZvG+vW7qP/AMbqS8vrrnfjppy/YsCGCDRsi6N27M23b+vLll+ElngXy/pLu0KElERHRaLWZHDt2hp07DxMU5G/zeZSQJTdXR1ZWNjq9Dr1OT1ZWNrm5Ojp0aMn585fZtu0gWVnZLFywhvr1fahVu3gfQ7JTq3DQ2KFWq1Db5f1sp1ZxMvYWvs8+ZRwhP12nIr7PPmU8xlylkjMeFfOmShs39GDYm02IWH7M2G/4SD9qV3dj8IRtZGVb5mOKSthfD5o8eSHx8VeJipqIo2MZq2S4R2nbJj9qlcFst9JGZTAYLJo6OzubWbNmsXHjRtzc3Lhy5Qr29va0aNGCKVOmUK1aUY+1nCtWnrNnL/Dvf39BbOxF1Go1L774HBMnDqZSpQrF6re4IiNXcenSdebM+cBqGVJSUhk//jMOHjyBm5srH3zQj+7d20oeC2QxULS3XWTkKhbMX2PSNiykN6GhfTh48ARTwxdz7dotnnu+Hp98MgJv7yqF7rtewN6H2kL7NWV4P9OTIiOWHyNy+W/0feVp3u7ZiIoVnEhOyWTlxjMs/fYkAC889xSzxrWlopsT12+lseDr39i0Mx6AqlXKsmf1G2Rl55qMlCd9us94H4Dzu0w/N/0klPLaSUy8SUDAuzg4aLC3v38tq7CwYQQGlnwesMS2qWeuaCYiz2w3W1+hT3c0W18lweKF+R6tVsvly5fR6/V4enpSocKTFsLiFWYhlKCohdmSHlWYrckchVmUJMsU5oVmLMxDS1lhLrGDHc7OzjRo0KCkVieEEEKUSnKtbCGEEIpTGs+mNhcpzEIIIRSnNJ60ZS42d0lOIYQQQslkxCyEEEJxbPnKX1KYhRBCKI4tH2OWqWwhhBBCQWTELIQQQnFsecQshVkIIYTi2HJhlqlsIYQQQkFkxCyEEEJx7Gz4c8xSmIUQQiiOLU/n2vJzF0IIIRRHRsxCCCEUx5ZP/pLCLIQVqFDO/zpK+5rFGs9/Z+0IJi793svaEWySLRdmmcoWQgghFERGzEIIIRRHzsoWQgghFESmsoUQQgihCDJiFkIIoTi2PGKWwiyEEEJxbLkwy1S2EEIIoSAyYhZC/H97dx4f073/cfw1k2RCIhFbCLlIiaWoLaglSEgt19KokptK+SmiCFppS1xLgyptLUG5VO/tLXVvWxUUpbUvpdbbhrgIEZJYguyyzczvj9ykYunCZM43nc+zj3k0c8443/eckzOffL/nzDlCKMfOhnvMUpiFEEIoR2/DX5eSoWwhhBBCIdJjFkIIoRxb7jVKYRZCCKEcOStbCCGEEEqwucKcmprB2LFzaNFiIH5+w9m8eY9mWUJCptCs2QBatnyRli1fpEeP0ZplycvLJyIiCj+/4bRsOYj+/cezd+8xzfKAWttKpSy2lsfgYMf8mb05uG0spw9NYuu/X6Frx6eK53dsW5ed0aGcPfwG//roJWp5uD6wjIqu5TixeyJf/iOkxPRy5eyZHdGDk3sm8tOB1/n84yEWy11EtW0VHv4BnTq9TKtWg+jRI5QvvtiuaZ5HsdNZ7lHW2NxQdmTkChwc7Dl48FNiYy8SGhpJo0ZeeHvX0STP9OmhvPhiD03avldBgREPj6p8+ulcatasxt69x5g4cT6bNy/B07O6JplU2lYqZbG1PHb2epKuZTD4lTUkJqfh51ufZe8F0mPgR2Rl57FiwQDeensrO/eeZ9LYLiydH0hgyCclljFloh8XLqWgv2989N3pvbGz09MtcCWpaXd5uqHlf9dV21ahoQN5553xGAwOxMVd4eWXI2jcuB5Nm9bXJM+jyFnZNiI7O4cdOw4xYcIQnJ3L4+PTBH//tmzcuFvraJpzcipHWFgwnp7V0ev1+Pm1xdOzOqdPX9Akj0rbSqUstpjn7t18Fq3Yz9WkNMxm2LXvAlcS02jWuAY9uzXkfFwKW789S26ekYUr9vN0A3fq1a1S/O9bN69Fw/rV+GLjjyWWW69uFbp38WZK5FZu38nGZDITE3vNIpmLqLatALy962AwOACg0+nQ6XQkJCRrlkc8yKYKc3x8InZ2ery8ahVPa9TIiwsXEjTL9MEH/6Rdu2CCgt7kyJGfNMtxv5SUO8THJ1K/fm1N2ldpW6mURfJA1crOeNWpzLm4FBrUq8aZczeK5929m8/lq6k0qFcVAL1eR+SUHkybuwOzuWQPrHlTDxKT03jt1c6c3DOR7V+OoFe3hhbNqtq2KjJz5oc0b/4CvXq9SrVqlejSxUfTPA+j11nuUdaUemFu164ds2fPJjY2trSb+lXZ2TlUqOBUYpqLizNZWXc1yRMePozvvlvF/v2fMHhwD0aPnqXEX675+QWEh39AYKA/9er9SZMMKm0rlbLYeh57ez2L5/Zj/eafiIu/hbOTAxmZOSVek5GRg7OzAYD/C/bh5E9JD+0Je1R3pZG3OxmZubTtHsX0uTv4YHZf6ntVeeC1j0u1bVVk5swxnDjxOWvXvktAQIfiHrRKpDCXImdnZ/R6PcOHDycwMJA1a9aQlpZW2s0+lJNTOTIzs0tMy8zMxtm5vCZ5mjdvSIUKThgMDgQGdqNVq8aan3BlMpl4880FODjYM22adiejqbStVMpiy3l0Olg4px/5+Uamzy08YSkrOx8XZ8cSr6tQwZGsrDzcq1Xg/4Lb8N6SPQ9dXk5uPnn5RpasOkB+gYkjxxP4/uhlfNs/9dDXPw7VttW97Ozs8PFpwrVrKaxbt1XrOOIepV6YK1asSEREBPv27SM0NJR9+/bRtWtXXnvtNQ4ePFjazZdQt24tjEYT8fFJxdPOnr2k2XDt/XQ6Hhhusyaz2czUqVGkpKSyZMkUHBy0OzdQpW2lUhZbzjP/7T9TrYozoZO+oqDABMC5uJs0buBe/Jry5R2o41mJc3EptGhak2pVK/DdhlEc3TmeGW8G0LxpTY7uHI9er+PsuZsPtGHp/U+1bfUwRqORhATLHlu3BL0FH2WN1TI7ODjQs2dPVq5cyTfffEPDhg2ZNWuWtZoHCv96DQhoT1TUWrKzczh+/Aw7dx6hf38/q+YASE/PZP/+E+Tm5lFQYGTTpj0cO3YaX9/WVs9SZMaMD4mLu8qKFdMoV87x1/9BKVJpW6mUxVbzzPlrT+p7VWV42Ofk5hYUT9++6xwN6lejV7eGOBrsmBDaidjzN4iLv8WeA3F06rWM3oNW03vQahZ8uJ/TZ6/Re9BqTCYzR04kkJScxthXOmBnp8OnhSft29Rh36GLFsut2ra6dSuVLVv2kZV1F6PRyP79J9iyZR/t2zfXJM8v0eks9yhrdOZS7qI9//zzREdHW3CJ557oX6emZhARsZhDh07h5ubCpElD6du3q2Wi/Q63b6cxcuRMLl4sPDnkqac8mTDhJTp2bGn1LACJiTfw938Fg8EBe3u74ulvvz2Wfv26apJJlW2lWpY/ep46zb8s8byWhyuHvhlHTm4BRqOpeHrErG1Ebz1Nx3Z1iZzSA08PV07+lET49K+5mvTg4bKB/ZoRNKAFA4d9WjzNu15V5s/oTaMG7iQmpfPe0j1s31XyM+byfwY+1vsootK2un07jfHj53L2bDwmk4latdwJCenLoEFP8pXNBhbLd68fbm6x2LLaVvuzxZZlDaVemBMTE6lVq9avv/A3e7LCLIRQ2/2FWWtPWpj/+EqnMB+1YGFuU8YKc6kfRLRsURZCCGELyuIQtKWUxePiQgghxB+WzV2SUwghhPpsudcohVkIIYRydBpdK9vf3x+DwYCjY+E3U8LDw/H19eXUqVNMnz6d3NxcatWqxXvvvUeVKoUXo/mleY/Dlv8oEUIIIR4QFRXFxo0b2bhxI76+vphMJt544w2mT5/O9u3b8fHx4f333wf4xXmPSwqzEEII5egs+EhPT+fq1asPPNLT039TlpiYGBwdHfHxKbymeFBQEN98882vzntcMpQthBBCOZY8K/uTTz5h6dKlD0wfN24cYWFhD0wPDw/HbDbTunVrXn/9dZKTk6lZs2bx/MqVK2MymUhNTf3FeW5ubo+VVwqzEEKIP7ShQ4cSGBj4wHRXV9cHpq1duxYPDw/y8vKYM2cOkZGRBAQEWCNmMSnMQgghlGPJrzG7uro+tAg/jIeHBwAGg4Hg4GBeffVVXn75ZZKSfr7e+e3bt9Hr9bi5ueHh4fHIeY9LjjELIYRQjha3fczOziYjIwMovKHJ1q1bady4MU2bNiUnJ4djxwrv/vevf/2Lnj17AvzivMclPWYhhBACuHXrFmFhYRiNRkwmE/Xq1WPGjBno9Xrmz5/PjBkzSnwlCvjFeY+r1K+VbXlyrWwh/sjkWtllTelcK/v0na8ttqwmlfpYbFnWID1mIYQQypFrZQshhBBCCdJjFkIDZtQ5gqSz6PmvT061oWNv391aRyjh/H4/rSNYhVq/ldYlhVkIIYRypDALIYQQCvk9X3P6o5FjzEIIIYRCpMcshBBCOTbcYZbCLIQQQj1a3Y9ZBTKULYQQQihEesxCCCGUI0PZQgghhELkyl9CCCGEUIL0mIUQQijHlnuNUpiFEEIoR4ayhRBCCKEE6TELIYRQjg13mG2vx5yamsHYsXNo0WIgfn7D2bx5j2RRNE+R+PgkmjUbQHj4B5pl0HrdrFnzNS8MeJ1mTQcwefKi4ul5efmMH/8u/v4jaNSwH0eO/GTVXEW0Xj/3ysvLJyIiCj+/4bRsOYj+/cezd+8xiy1/yIAmfLVqAKd3jmBeRNcS817s04jv1gVxavtwVr/fG/cqTsXzRvylOVs+eZGT2/+PXf/+CyP+0rx4nod7BU5tH17icX5/KMMHP2Ox3PdTYb/6JTqd5R5ljc31mCMjV+DgYM/Bg58SG3uR0NBIGjXywtu7jk1nUTHPz7mW06yZt8YZtF037u6VeXXMIA7sP0FObl6Jea1bNWboy/2YOHGeVbI8jNbr514FBUY8PKry6adzqVmzGnv3HmPixPls3rwET8/qT7z8GynZfPjPE/i29aSc488foW1beDBpVFuGjN/M5atp/HVCBxbO7MZLYZuBwgLxxpzd/DfuFrVruvL3BX8m+UYmW3bGkXwjkxY9Pi5elqeHC9+tC2L73otPnPdRVNivxMPZVI85OzuHHTsOMWHCEJydy+Pj0wR//7Zs3Gj9+62qlEXFPEW2bNmHi4sz7ds3//UXlxIV1s1zz3Wge/dncXNzLTHdYHBg6LD+tPZ5Gr1em91ZhfVzLyencoSFBePpWR29Xo+fX1s8Patz+vQFiyx/x75LfLc/ntS03BLT/TrUYdvui1yIv0N+gYll/zhB2xY1qV2zcJut+uw/nDmXgtFo5tKVNHYeiKdVsxoPbeP5Hg04+p9kEq9lWiTz/VTYr36NzoKPssbqe/Ldu3eJiYkhPT3d2k0TH5+InZ0eL69axdMaNfLiwoUEm86iYh6AzMxsoqLWMmXKCM0ygJrrRiWqr5+UlDvExydSv37tUm/r3mHTop+9n6r00Nf6POPBhUu3HzovsKc3G745Z+l4gDr71a/R6yz3KGtKvTB/++23tGrVip49e/Ljjz/Su3dv3nzzTQICAti1a1dpN19CdnYOFSo4lZjm4uJMVtZdq+ZQLYuKeQAWLVrDCy8EUKNGVc0ygJrrRiUqr5/8/ALCwz8gMNCfevX+VKpt7T9yhV5+T9GwXmUcDXaMG9Yak8lMeccHjxiOH+6DTq9j/db/PjDP55kaVKnkxDd7SmcYW5X9SjxaqR9jXrZsGevWrSM9PZ2RI0eyfPlyWrVqRVxcHJMmTcLf37+0IxRzcipHZmZ2iWmZmdk4O5e3WgYVs6iYJzb2It9/f4oNGxZr0v69VFs3qlF1/ZhMJt58cwEODvZMmza61Ns7dDyRqI+Ps3TWc1RwduAfX/xEVnYe125mlXjdkAFNeL6HN8HjNpGXb3pgOYG9GrB970Wy7xZYPKNK+9WvKYMdXYuxyslfDRs2BMDZ2ZlWrVoBUK9ePWs0XULdurUwGk3ExydRt25NAM6evWSVIS6Vs6iY58iRn0hMvIGf33CgsFdmNJoIDEyw+oeKautGNSquH7PZzNSpUaSkpLJq1QwcHKxznuvaDadZu+E0AHX/VJExL7fi3MWfh6sH9m5I6EstCB636YGCDeBosKNX16cYM3VHqeRTab/6NXLbx1Kk0+mIi4vj5MmTZGdnc+rUKQAuXbqE0Wgs7eZLcHIqR0BAe6Ki1pKdncPx42fYufMI/fv7WTWHallUzDN4cA++/XYV0dFRREdHERTUk65dfVi9OtLqWVRYNwUFRnJz8zCajJiMJnJz8ygoKNx/8vLyyf3fmdr5+QXk5uZhNlvvQ02F9XO/GTM+JC7uKitWTKNcOUeLLtvOTofBYIfeTodeX/hz0TRvr8LjyR7uFZj9Rmc++TKG9MzCbdMvoD6vj2rLsNe3cCU546HLfq6zF2kZeRw+kWTRzEVU2q/Eo+nMpbwH7969m7feegu9Xs/ChQtZuXIlN2/e5Nq1a8ycOZM+ffr8ziU+2QkRqakZREQs5tChU7i5uTBp0lD69u36RMv8I2RRMc+9liz5jMuXk3n//UmatG/pdWPm9+12S5Z8xrKl/yoxbey4IMLCgvH3H0FS4o0S877bueo3fzVIZ4FBQ5V+dxITb+Dv/woGgwP29nbF099+eyz9+v3+TN6+Jc8uD/u/1owf7lNiWtTHx/jHFz/x2dJ+1K7pSlZ2Puu3/ZeFq45iMhVu613//gs13J3Jy/t5+HrTjvNM/2B/8fOPP+jNj2dusGj1o793fX6/5f7gscx+1cBiee51/e4miy2revl+FluWNZR6Yb6f0WgkNjaWGjVqULXq45x8UDpnKgphTb+3MJcmSxTmP7L7C7PWLFmYLaN0CvONHMsVZvdyZaswW/0CI3Z2djRt2tTazQohhBBlgs1d+UsIIYT6bHkcRwqzEEII5djUZSnvY8vvXQghhFCO9JiFEEIopyzeFcpSpDALIYRQkO1WZhnKFkIIIRQiPWYhhBDKseXv10thFkIIoRydznYHdG33nQshhBAKkh6zEEIIBclQthBCCKEMWz7GLEPZQgghhEKkxyyEEEJBtttjlsIshAZseZiurFHtNov1fbZpHaGEC8dK57aPcla2EEIIIZQgPWYhhBAKst1RJSnMQgghlGPLh3tkKFsIIYRQiPSYhRBCKMeWe8xSmIUQQijIdgd0bfedCyGEEAqSHrMQQgjl6HQylC2EEEIoxHYLswxlCyGEEAqRHrMQQgjlyFnZQgghhFJsd0DXdt+5EEIIoSCbK8ypqRmMHTuHFi0G4uc3nM2b92iWZc2arxkw4DWaNg1k8uSFmuUootK6US3P1avXGTlyJm3aBNGxYwiRkSsoKDBKnv9RaVsViY9PolmzAYSHf6BpjtLez0MGPcOGfwZx5tBY5s0IKDFvUP8m7NwwlP/se5WPo/rjXtW5eJ5LBQPzZwZwZMdIjuwYyfhR7R5Y9tCgFuzeOIwf94/hmy9CqFvbzeL5H0Vnwf/KGpsbyo6MXIGDgz0HD35KbOxFQkMjadTIC2/vOlbP4u5emTFjBrF//0lyc3Ot3v79VFo3quV5++3lVKlSkQMH/kl6ehbDh0/js8+28PLL/ayeRcU8Km2rnzMtp1kzb83aL1La+/n1m1ksW/0Dvu3rUM7x54/0dq1rMWlsB4aMXk98Qip/De/Cojk9CQ5dD8DU17tQvpwDXfr+nSqVy/Pp8gEkJmewfvMZoLCov9i/CSMnbuLCpdvUrlWRtIwci+d/FFv+upRN9Zizs3PYseMQEyYMwdm5PD4+TfD3b8vGjbs1yfPccx3o3r09bm4umrR/L9XWjWp5rl69Tq9evjg6GqhWrRKdOrXiwoUETbKolke1bQWwZcs+XFycad++uWYZipT2fr5jdxzf7b1IalrJounXyYtt353n/MXb5BeYWPbRD7Rt7UntWhUB8O/sxcp/Hicnt4DE5Ay+2HiGgf2eBkCng7CR7ZizYB8XLt0GICExjbR07TsQtsBqhTk1NZXY2FjOnTtHTo71/uq6V3x8InZ2ery8ahVPa9TIS9MPWFWotm5UyzN0aD+2bNnH3bs5XL9+i/37j+Pr21qTLKrlUW1bZWZmExW1lilTRmjSvkru7XUW/digfpUHphU+gQb1CufVcHfBo4YLDepVYf/Xw9m9cRgTRj2LdTuxOgs+ypZSL8yJiYmMGDGCZ599lgEDBhASEkK7du149913ycvLK+3mS8jOzqFCBacS01xcnMnKumvVHCpSbd2olqdNm6ZcuJBA69aD6dx5GE2b1qd792c1yaJaHtW21aJFa3jhhQBq1KiqSfuq2Pf9ZXoFeNOwflUcHe0YN7IdJpOZcuUKh7v3H7pM6FAfnJ0cqONZkRf7PU35/82rUb0CAJ2erU3voDUMGb2ePj0aMKh/E6vl16G32KOsKfXEkydPpl+/fhw5coSIiAheeukldu3aRUZGBnPnzi3t5ktwcipHZmZ2iWmZmdk4O5e3ag4VqbZuVMpjMpkYMWIGAQHtOXXqSw4fXktaWhbvvfcPq2dRMY9K2yo29iLff3+KYcP6W71t1Rz64QpRfzvMsvl/Zu+m4SQmpZOVnce165kARL6/h5zcAr77aigrPujL5u3nuHajcF5ubgEAq/55nIzMPBKTM/jXVz/RpWNdK74D6TGXmrS0NPr160fFihUJCQlh3759VKlShVmzZnHw4MHSbr6EunVrYTSaiI9PKp529uwl6tevbdUcKlJt3aiUJzU1g6SkmwwZ0geDwYFKlVx54YVu7Nt3zOpZVMyj0rY6cuQnEhNv4Oc3nI4dQ/j44w3s2HGIwMAJVs+igjVf/Ej3AZ/wbI9VfLPrAnZ2es7F3QIgLT2XSdO2077nR/QavAa9Tsd/Tl8H4GL8HfLyCjCbzcXLMj+0BVEaSr0w29vbk5BQeKwpJiYGg8FQ2LBej729dU8Kd3IqR0BAe6Ki1pKdncPx42fYufMI/fv7WTVHkYICI7m5eZhMJoxGE7m5eZp95UW1daNSnsqVK+LpWZ1167ZSUGAkPT2TDRt20bBhXatnUTGPSttq8OAefPvtKqKjo4iOjiIoqCddu/qwenWk1bMUKe393M5Oh8Fgh51e9/PP//u/9/+OGXtUd2HO1G58su4U6RmFJ3DVrlURt4rl0Ot1dO5Qh8EDmvLh6h8AyMktYMu35xn5cuFQdw33CgwObMruA/EWy/1rdDqdxR5ljc58759EpWDPnj1MnjyZatWqcfPmTRYuXEj79u1JSUlh0aJFzJ49+3cu8dwT5UlNzSAiYjGHDp3Czc2FSZOG0rdv1yda5uNasuQzli5dV2LauHF/ISwsWJM8Kq0b1fLExl7knXdWcfbsJfR6Pc8++wzTpoVStWolyYNa2+peS5Z8xuXLybz//iRNM1hyP6/vs63E8/Gj2jF+VMnzC6JWHubvn51k3aoXqe1ZkaysPNZvPsOC5d9jMhV+5Pfu7s3USZ1xdXHk0uVU3ltygP2Hfz5hr4KzgdlT/ena0YuMjFz+HR3D0o9+eCDPhWOlMxqRZzpusWUZ9NqdqPk4Sr0wA6Snp3P58mW8vLyoUKHCEy7tyQqzEEKUZfcXZq1JYbY8q4wlu7q60qxZM2s0JYQQ4g+gLJ5NbSk2d+UvIYQQZUHZOzZsKbb7J4kQQgihIOkxCyGEUE5ZvPmEpUhhFkIIoZyy+DUnS5GhbCGEEEIh0mMWQgihINvtN0phFkIIoRxbPsZsu3+SCCGEEAqSHrMQQggF2W6PWQqzEEII5chZ2UIIIYTg0qVLDB48mB49ejB48GDi4+OtnkEKsxBCCAXpLfj47WbMmEFwcDDbt28nODiY6dOnW+Td/B4ylC2EEEI5ljwrOz09nfT09Aemu7q64urqWvz81q1bnDlzhr///e8A9OnTh1mzZnH79m0qV65ssTy/pgwW5gZaBxBCCM1cOGYrn4GWe5+ffLKEpUuXPjB93LhxhIWFFT9PTk6mevXq2NnZAWBnZ4e7uzvJyclSmIUQQghLGTp0KIGBgQ9Mv7e3rBIpzEIIIf7Q7h+yfhQPDw+uX7+O0WjEzs4Oo9HIjRs38PDwsELKn8nJX0IIIQRQpUoVGjduzNdffw3A119/TePGja06jA2gM5vNZqu2KIQQQigqLi6OyZMnk56ejqurK/PmzeOpp56yagYpzEIIIYRCZChbCCGEUIgUZiGEEEIhUpiFEEIIhUhhFkIIIRRic99jvnTpEpMnTyY1NRU3NzfmzZtH3bp1Nckyb948tm/fw5XhOwAACKdJREFUTmJiIps3b6ZBA+2u6HPnzh3efPNNEhISMBgM1KlTh8jISKt/TeBeY8aM4erVq+j1epycnJg2bRqNGzfWLA/A0qVLWbJkiebby9/fH4PBgKOjIwDh4eH4+vpqlic3N5d33nmH77//HkdHR1q0aMGsWbM0yXL16lXGjh1b/DwjI4PMzEx++OEHTfIA7N69m8WLF2M2mzGbzYwbN47nnntOkyx79uxh8eLFFBQUULFiRebOncuf/vQnTbKIRzDbmJCQEHN0dLTZbDabo6OjzSEhIZplOXr0qDkpKcns5+dn/u9//6tZDrPZbL5z54758OHDxc/fffdd85QpUzRMZDanp6cX//ztt9+an3/+eQ3TmM0xMTHmV155RYntpUKGe82aNcs8Z84cs8lkMpvNZvPNmzc1TvSz2bNnm99++23N2jeZTGYfH5/i7RUbG2tu0aKF2Wg0Wj1LamqquW3btuaLFy+azebCz8Dhw4dbPYf4ZTY1lF10gfI+ffoAhRcoP3PmDLdv39Ykj4+Pj9WvKPMobm5utGvXrvh5ixYtSEpK0jARuLi4FP+cmZmp6f1Z8/LyiIyMZObMmZplUFVWVhbR0dFMmDCheBtVrVpV41SF8vLy2Lx5My+88IKmOfR6PRkZGUBhD97d3R293vofv5cvX6Zq1ap4eXkB0KVLFw4cOKDZZ6B4OJsaylblAuWqM5lMrFu3Dn9/f62jMHXqVA4ePIjZbOajjz7SLMfixYvp168fnp6emmW4X3h4OGazmdatW/P6669rdt3fK1eu4ObmxtKlSzly5AjOzs5MmDABHx8fTfLca9euXVSvXp0mTZpolkGn07Fo0SLGjBmDk5MTWVlZrFy5UpMsXl5epKSk8OOPP/LMM8+wefNmAPkMVIxN9ZjFbzNr1iycnJwYMmSI1lGYM2cOe/bs4bXXXmP+/PmaZDh58iQxMTEEBwdr0v7DrF27lk2bNrF+/XrMZjORkZGaZTEajVy5coWnn36ar776ivDwcMLCwsjMzNQsU5H169dr3lsuKCjgb3/7Gx9++CG7d+9m+fLlTJw4kaysLKtncXFxYeHChcydO5cBAwZw69YtXF1dizsrQg02VZjvvUA5oNkFylU2b948Ll++zKJFizQZanuU559/niNHjnDnzh2rt3306FHi4uLo1q0b/v7+XLt2jVdeeYUDBw5YPUuRot9Zg8FAcHAwJ06c0DSLvb198SGi5s2bU6lSJS5duqRZJoDr169z9OhR+vbtq2mO2NhYbty4QevWrQFo3bo15cuXJy4uTpM8HTp0YN26dXz11VcMGTKEnJwcateurUkW8XDqfPJagSoXKFfVggULiImJYdmyZRgMBk2zZGVlkZycXPx8165dVKxYETc3N6tnGTVqFAcOHGDXrl3s2rWLGjVqsHr1ajp16mT1LADZ2dnFxyvNZjNbt27V9Gz1ypUr065dOw4ePAgUfvPh1q1b1KlTR7NMABs2bKBLly5UqlRJ0xw1atTg2rVrXLx4ESi8FvOtW7c0K4Y3b94ECg9ZLViwgKCgIJycnDTJIh7O5q6VrcIFyovMnj2bHTt2kJKSQqVKlXBzc2PLli2aZDl//jx9+vShbt26lCtXDgBPT0+WLVumSZ6UlBTGjBnD3bt30ev1VKxYkbfeekvTY4VF/P39WbFihWZfl7py5QphYWEYjUZMJhP16tXjr3/9K+7u7prkKcoUERFBamoq9vb2TJw4kS5dumiWB6BHjx5MnTqVzp07a5oDYNOmTaxatar45Ljx48fTvXt3TbJMnTqVEydOkJ+fT8eOHYmIiCj+2p1Qg80VZiGEEEJlNjWULYQQQqhOCrMQQgihECnMQgghhEKkMAshhBAKkcIshBBCKEQKsxAau3r1Kg0bNqSgoACAESNGsGHDBo1TCSG0YlPXyhbiSfj7+5OSkoKdnR3ly5enc+fOTJs2DWdnZ4u281uvCe7v78/s2bPp0KGDRdsXQmhLesxC/A4rVqzg5MmTbNiwgZiYGJYvX15ivtlsxmQyaZROCPFHIIVZiMdQvXp1fH19OX/+PCEhISxcuJCgoCCaN2/OlStXyMjIICIigk6dOuHr68vChQtLXKN93rx5tGvXjm7durF3794Syw4JCeGLL74ofv7555/Tq1cvWrZsSe/evTl9+jRvvPEGSUlJjB49mpYtW7Jq1Sqrvn8hROmRoWwhHkNycjL79u0jICCA48ePs3HjRlatWoWXlxdms5mJEydSpUoVduzYwd27dwkNDcXDw4OgoCA+//xzdu/eTXR0NOXLlycsLOyR7Wzbto0lS5awbNkymjVrRkJCAvb29rz33nscP35chrKF+AOSHrMQv8PYsWPx8fEhODiYNm3aMHr0aAACAwPx9vbG3t6etLQ09u7dS0REBE5OTlSpUoVhw4YVXwd927ZtDB06FA8PD9zc3AgNDX1ke19++SUjRozgmWeeQafTUadOHWrVqmWV9yqE0Ib0mIX4HZYtW/bQHuq9tw5NSkqioKCgxN2nTCZT8Wvuv9VozZo1H9lecnKy3JJPCBsjhVkICyi6axAU3ubPYDBw+PBh7O0f3MWqVatW4paW9/58Pw8PDxISEiwbVgihNBnKFsLC3N3d6dixI++++y6ZmZmYTCYSEhL44YcfAOjVqxeffvop165dIy0tjZUrVz5yWQMHDuTjjz8mJiYGs9nM5cuXSUxMBKBq1apcuXLFKu9JCGE9UpiFKAXz588nPz+f3r1706ZNG8aPH198g/pBgwbRqVMn+vfvT2BgIM8999wjl9OrVy9Gjx7NpEmTaNWqFWPHjiUtLQ2AUaNGsXz5cnx8fFi9erVV3pcQovTJ/ZiFEEIIhUiPWQghhFCIFGYhhBBCIVKYhRBCCIVIYRZCCCEUIoVZCCGEUIgUZiGEEEIhUpiFEEIIhUhhFkIIIRQihVkIIYRQyP8DOpz4gFCxbCMAAAAASUVORK5CYII=" alt="img"></p>
<h2 id="七、思考题"><a href="#七、思考题" class="headerlink" title="七、思考题"></a>七、思考题</h2><p><strong>深度算法参数的设置对算法性能的影响？</strong></p>
<p><strong>解答</strong></p>
<p>无论是从网络本身的层宽（宽度）、层数（深度）、连接方式，还是损失函数的超参数设计和调试，亦或者是学习率、批样本数量、优化器参数等等。这些大量的参数都会有网络模型最终的有效容限直接或者间接的影响，从而很大程度上影响着算法性能。现将深度算法参数的设置对算法性能的影响总结如下：</p>
<ul>
<li><strong>激活函数</strong></li>
</ul>
<p>​    激活函数给神经网络加入一些非线性因素，使得网络可以更好地解决较为复杂的问题。比如有些问题是线性可分的，而现实场景中更多问题不是线性可分的，若不使用激活函数则难以拟合非线性问题，测试时会有低准确率。所以激活函数主要是非线性的，如sigmoid、tanh、relu。sigmoid函数通常用于二分类，但要防止梯度消失，故适合浅层神经网络且需要配备较小的初始化权重，tanh函数具有中心对称性，适合于有对称性的二分类。在深度学习中，relu是使用最多的激活函数，简单又避免了梯度消失。</p>
<p>CNN的各部分层数，卷积核的形状，卷积核的数量，卷积层的步长以及Padding，池化层的选择，激活函数的选择。</p>
<ul>
<li><p><strong>CNN层数</strong></p>
<p>层数越多，模型的训练效果越好，但是训练时间也会相应增加，所以要结合实际进行设置。</p>
</li>
<li><p><strong>卷积核的形状kernel_size：</strong></p>
<p>决定了其提取的特征的数目，需要进行调参根据经验才能确定，当前还没有一个确定的算法计算。</p>
</li>
<li><p><strong>卷积层的步长和Padding：</strong></p>
<p>Padding &#x3D; 0会使得边缘的特征提取不完全；为了防止过拟合，可以加入Dropout层，将小于阈值的值赋值为0，进行丢弃。除此之外，还可以对优化器的学习率进行修改，较小的学习率会使收敛速率较慢，但是较大的学习率又会导致发散和欠拟合。</p>
</li>
</ul>
<p>为了防止过拟合，可以加入Dropout层，将小于阈值的值赋值为0，进行丢弃。</p>
<ul>
<li><strong>学习率learning_rate</strong></li>
</ul>
<p>​    学习率（learning rate或作lr）是指在优化算法中更新网络权重的幅度大小。学习率可以是恒定的、逐渐降低的，基于动量的或者是自适应的。不同的优化算法决定不同的学习率。当学习率过大则可能导致模型不收敛，损失loss不断上下震荡；学习率过小则导致模型收敛速度偏慢，需要更长的时间训练。通常lr取值为[0.01,0.001,0.0001]</p>
<p>​    查看相关资料后，学习速率应该自适应地减小，是存在专门的一些算法的，等待进一步应用优化本实验网络搭建。</p>
<ul>
<li><p><strong>批次大小batch_size</strong></p>
<p>批次大小是每一次训练神经网络送入模型的样本数，在卷积神经网络中，大批次通常可使网络更快收敛，但由于内存资源的限制，批次过大可能会导致内存不够用或程序内核崩溃。bath_size通常取值为[16,32,64,128]</p>
</li>
<li><p><strong>优化器optimizer</strong></p>
<p>本次实验中选择的是自适应梯度Adagrad 优化器方法，并将学习率定义在了0.0015，如下所示：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 学习率</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.0005</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.001</span></span><br><span class="line">LEARNING_RATE = <span class="number">0.0015</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Adam 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.Adam(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># SGD 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.SGD(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># RMSProp 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.RMSProp(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># Adagrad 优化器</span></span><br><span class="line">optimizer = fluid.optimizer.AdagradOptimizer(learning_rate=LEARNING_RATE)</span><br><span class="line"></span><br><span class="line">opts = optimizer.minimize(avg_cost)</span><br></pre></td></tr></table></figure>

<p><strong>Adagrad的特点：</strong></p>
<ul>
<li>前期gt较小的时候， regularizer较大，能够放大梯度</li>
<li>后期gt较大的时候，regularizer较小，能够约束梯度</li>
<li>适合处理稀疏梯</li>
</ul>
<p><strong>Adagrad的缺点：</strong></p>
<ul>
<li>由公式可以看出，仍依赖于人工设置一个全局学习率，这个学习率需要根据业务模型和实际测试决定。</li>
<li>η设置过大的话，会使regularizer过于敏感，对梯度的调节太大</li>
<li>中后期，分母上梯度平方的累加将会越来越大，使gradient→0，使得训练提前结束</li>
</ul>
<p>较小的学习率会使收敛速率较慢，但是较大的学习率又会导致发散和欠拟合。</p>
<blockquote>
<p>目前Adam是快速收敛且常被使用的优化器。随机梯度下降(SGD)虽然收敛偏慢，但是加入动量Momentum可加快收敛，同时带动量的随机梯度下降算法有更好的最优解，即模型收敛后会有更高的准确性。通常若追求速度则用Adam更多。</p>
</blockquote>
<ul>
<li><strong>迭代次数epochs</strong></li>
</ul>
<p>​    迭代次数是指整个训练集输入到神经网络进行训练的次数，当测试错误率和训练错误率相差较小时，可认为当前迭代次数合适；当测试错误率先变小后变大时则说明迭代次数过大了，需要减小迭代次数，否则容易出现过拟合。</p>
<p><strong>部分超参数如何影响模型性能</strong></p>
<p>对部分超参数对算法性能的影响及原因、注意事项总结如下：</p>
<p>(由于格式限制，该部分在下一页显示)</p>
<table>
<thead>
<tr>
<th align="center">超参数</th>
<th align="center">如何影响模型容量</th>
<th align="center">原因</th>
<th align="center">注意事项</th>
</tr>
</thead>
<tbody><tr>
<td align="center">学习率</td>
<td align="center">调至最优，提升有效容量</td>
<td align="center">过高或者过低的学习率，都会由于优化失败而导致降低模型有效容限</td>
<td align="center">学习率最优点，在训练的不同时间点都可能变化，所以需要一套有效的学习率衰减策略</td>
</tr>
<tr>
<td align="center">损失函数部分超参数</td>
<td align="center">调至最优，提升有效容量</td>
<td align="center">损失函数超参数大部分情况都会可能影响优化，不合适的超参数会使即便是对目标优化非常合适的损失函数同样难以优化模型，降低模型有效容限。</td>
<td align="center">对于部分损失函数超参数其变化会对结果十分敏感，而有些则并不会太影响。在调整时，建议参考论文的推荐值，并在该推荐值数量级上进行最大最小值调试该参数对结果的影响。</td>
</tr>
<tr>
<td align="center">批样本数量</td>
<td align="center">过大过小，容易降低有效容量</td>
<td align="center">大部分情况下，选择适合自身硬件容量的批样本数量，并不会对模型容限造成。</td>
<td align="center">在一些特殊的目标函数的设计中，如何选择样本是很可能影响到模型的有效容限的，例如度量学习（metric learning）中的N-pair loss。这类损失因为需要样本的多样性，可能会依赖于批样本数量。</td>
</tr>
<tr>
<td align="center">丢弃法</td>
<td align="center">比率降低会提升模型的容量</td>
<td align="center">较少的丢弃参数意味着模型参数量的提升，参数间适应性提升，模型容量提升，但不一定能提升模型有效容限</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">权重衰减系数</td>
<td align="center">调至最优，提升有效容量</td>
<td align="center">权重衰减可以有效的起到限制参数变化的幅度，起到一定的正则作用</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">优化器动量</td>
<td align="center">调至最优，可能提升有效容量</td>
<td align="center">动量参数通常用来加快训练，同时更容易跳出极值点，避免陷入局部最优解。</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">模型深度</td>
<td align="center">同条件下，深度增加，模型容量提升</td>
<td align="center">同条件，下增加深度意味着模型具有更多的参数，更强的拟合能力。</td>
<td align="center">同条件下，深度越深意味着参数越多，需要的时间和硬件资源也越高。</td>
</tr>
<tr>
<td align="center">卷积核尺寸</td>
<td align="center">尺寸增加，模型容量提升</td>
<td align="center">增加卷积核尺寸意味着参数量的增加，同条件下，模型参数也相应的增加。</td>
<td align="center"></td>
</tr>
</tbody></table>
<h2 id="八、实验心得"><a href="#八、实验心得" class="headerlink" title="八、实验心得"></a>八、实验心得</h2><p>​    作为一个深度学习小白，盲目地去增加卷积层数目或着是通道注意力，甚至是各种concat组装，这可能都是在浪费时间，就像是把神经网络纯当黑盒，希望瞎猫碰见死耗子。此外，尽管网络调参很重要，但是过分花费时间在这上面也不合理，深入挖掘底层原理，合理分析网络结构才能对研究任务有更深入的理解。做实验思路很重要，首先应当找到研究点(即出发点)，找到目前方法或现有方法的不合理或者不完善的地方，作为自己方法的动机；其次去思考如何解决自己分析出的问题，这个idea的产生可能需要阅读大量文献，包括其他领域的，甚至需要绘图可视化和合理的公式推导。</p>
<p>​    同时关于训练深度学习模型最难的事情之一是我们要处理的参数的数量。无论是从网络本身的层宽（宽度）、层数（深度）、连接方式，还是损失函数的超参数设计和调试，亦或者是学习率、批样本数量、优化器参数等等。这些大量的参数都会有网络模型最终的有效容限直接或者间接的影响。面对如此众多的参数，如果我们要一一对其优化调整，所需的无论是时间、资源都是不切实际。结果证实一些超参数比其它的更为重要，因此认识各个超参数的作用和其可能会造成的影响是深度学习训练中必不可少的一项重要技能。</p>
<p>​    最后，作为本实验的扩展，可以进一步基于ResNet网络(2015年ImageNet图像分类、图像物体定位和图像物体检测比赛的冠军)进行手写数字识别，同时可以对图像处理进行更为细致的处理如图像增强、特征提取等操作，从而实现更多场景下的、更深一步的图像识别。本次实验使用的是百度的Paddle深度学习框架，同样地可以进一步尝试其他的开源深度学习框架谷歌的Tensorflow、Facebook的PyTorch、华为的MindSpore等等，从而在实践中找到适合当前任务的框架。</p>
<h2 id="附录：完整代码"><a href="#附录：完整代码" class="headerlink" title="附录：完整代码"></a>附录：完整代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import 需要的模块</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> paddle <span class="keyword">as</span> paddle</span><br><span class="line"><span class="keyword">import</span> paddle.fluid <span class="keyword">as</span> fluid</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压白底黑字数据集</span></span><br><span class="line">train_file = zipfile.ZipFile(<span class="string">&quot;/home/aistudio/data/data36874/train.zip&quot;</span>) </span><br><span class="line">train_file.extractall(<span class="string">&quot;/home/aistudio/data/data36874&quot;</span>)</span><br><span class="line"></span><br><span class="line">test_file = zipfile.ZipFile(<span class="string">&quot;/home/aistudio/data/data36874/test.zip&quot;</span>)</span><br><span class="line">test_file.extractall(<span class="string">&quot;/home/aistudio/data/data36874&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 白底黑字训练集标签</span></span><br><span class="line">train_labels_idx1 = <span class="string">&quot;/home/aistudio/data/data36874/train_examples_labels/train-labels.idx1-ubyte&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 白底黑字测试集标签</span></span><br><span class="line">test_labels_idx1 = <span class="string">&quot;/home/aistudio/data/data36874/test_examples_labels/t10k-labels.idx1-ubyte&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_idx1</span>(<span class="params">idx1_ubyte_file</span>):</span><br><span class="line">    <span class="comment"># 读取二进制数据</span></span><br><span class="line">    bin_data = <span class="built_in">open</span>(idx1_ubyte_file, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解析文件头信息</span></span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    fmt_header = <span class="string">&quot;&gt;ii&quot;</span></span><br><span class="line">    magic_number, num_images = struct.unpack_from(fmt_header, bin_data, offset)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解析数据集</span></span><br><span class="line">    offset += struct.calcsize(fmt_header)</span><br><span class="line">    fmt_image = <span class="string">&quot;&gt;B&quot;</span></span><br><span class="line">    labels = np.empty(num_images)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_images):</span><br><span class="line">        labels[i] = struct.unpack_from(fmt_image, bin_data, offset)[<span class="number">0</span>]</span><br><span class="line">        offset += struct.calcsize(fmt_image)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> labels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_label = decode_idx1(train_labels_idx1)</span><br><span class="line">test_label = decode_idx1(test_labels_idx1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图片预处理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">image_data_format</span>(<span class="params">file_url</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(file_url).convert(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    img = img.resize((<span class="number">28</span>, <span class="number">28</span>), Image.ANTIALIAS)</span><br><span class="line">    img = np.array(img).reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>).astype(np.float32)</span><br><span class="line">    img = img / <span class="number">255.0</span> * <span class="number">2.0</span> - <span class="number">1.0</span></span><br><span class="line">    img = img.reshape(<span class="number">28</span> * <span class="number">28</span>)</span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 data</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_data</span>(<span class="params">dir_name, isTest</span>):</span><br><span class="line">    data = []</span><br><span class="line">    data_urls = []</span><br><span class="line">    data_list = os.listdir(dir_name)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data_list)):</span><br><span class="line">        file_url = os.path.join(dir_name, data_list[i])</span><br><span class="line">        data_urls.append(file_url)</span><br><span class="line">    <span class="keyword">if</span> isTest:</span><br><span class="line">        data_urls.sort(key = <span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[<span class="number">60</span>:-<span class="number">4</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data_urls.sort(key = <span class="keyword">lambda</span> x: <span class="built_in">int</span>(x[<span class="number">62</span>:-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> data_url <span class="keyword">in</span> data_urls:</span><br><span class="line">        <span class="comment"># 将预处理的图片添加到 data list 里</span></span><br><span class="line">        data.append(image_data_format(data_url))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 reader</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_data_reader</span>(<span class="params">data, label</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reader</span>():</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            <span class="keyword">yield</span> data[i], <span class="built_in">int</span>(label[i])</span><br><span class="line">    <span class="keyword">return</span> reader</span><br><span class="line"></span><br><span class="line">train_data_reader = create_data_reader(create_data(<span class="string">&quot;/home/aistudio/data/data36874/train_examples_labels/train_new&quot;</span>, <span class="literal">False</span>), train_label)</span><br><span class="line">test_data_reader = create_data_reader(create_data(<span class="string">&quot;/home/aistudio/data/data36874/test_examples_labels/test_new&quot;</span>, <span class="literal">True</span>), test_label)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 缓存区数据数目</span></span><br><span class="line">BUF_SIZE = <span class="number">512</span></span><br><span class="line"><span class="comment"># 每次提取数据数目</span></span><br><span class="line">BATCH_SIZE = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 混合两个数据集</span></span><br><span class="line"><span class="comment"># 每次读取数据集中的 BUF_SIZE 个数据并进行随机</span></span><br><span class="line"><span class="comment"># reader 每次取出 BATCH_SIZE 个数据</span></span><br><span class="line">train_reader = paddle.batch(paddle.reader.shuffle(paddle.reader.chain(paddle.dataset.mnist.train(), train_data_reader), buf_size=BUF_SIZE), batch_size=BATCH_SIZE)</span><br><span class="line">test_reader = paddle.batch(paddle.reader.chain(paddle.dataset.mnist.test(), test_data_reader), batch_size=BATCH_SIZE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 Lenet-5 卷积神经网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lenet_5_net</span>():</span><br><span class="line">    data_type = fluid.layers.data(name=<span class="string">&#x27;image&#x27;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv1 = fluid.layers.conv2d(data_type, <span class="number">6</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">2</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool1 = fluid.layers.pool2d(conv1, <span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv2 = fluid.layers.conv2d(pool1, <span class="number">16</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool2 = fluid.layers.pool2d(conv2, <span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv3 = fluid.layers.conv2d(pool2, <span class="number">120</span>, filter_size=<span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    flatten = fluid.layers.flatten(conv3, axis=<span class="number">1</span>)</span><br><span class="line">    fc1 = fluid.layers.fc(flatten, <span class="number">84</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    fc2 = fluid.layers.fc(fc1, <span class="number">10</span>, act=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fc2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 VGG 卷积神经网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vgg_net</span>():</span><br><span class="line">    data_type = fluid.layers.data(name=<span class="string">&#x27;image&#x27;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv1 = fluid.layers.conv2d(data_type, num_filters=<span class="number">128</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">3</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool1 = fluid.layers.pool2d(conv1, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv2 = fluid.layers.conv2d(pool1, num_filters=<span class="number">256</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool2 = fluid.layers.pool2d(conv2, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv3 = fluid.layers.conv2d(pool2, num_filters=<span class="number">768</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool3 = fluid.layers.pool2d(conv3, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv4 = fluid.layers.conv2d(pool3, num_filters=<span class="number">1536</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool4 = fluid.layers.pool2d(conv4, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    conv5 = fluid.layers.conv2d(pool4, num_filters=<span class="number">1536</span>, filter_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    pool5 = fluid.layers.pool2d(conv5, pool_size=<span class="number">2</span>, pool_stride=<span class="number">2</span>, pool_type=<span class="string">&#x27;max&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    drop = fluid.layers.dropout(x=pool5, dropout_prob=<span class="number">0.5</span>)</span><br><span class="line">    fc1 = fluid.layers.fc(drop, size=<span class="number">256</span>, act=<span class="literal">None</span>)</span><br><span class="line">    bn = fluid.layers.batch_norm(fc1, act=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">    drop2 = fluid.layers.dropout(x=bn, dropout_prob=<span class="number">0.0</span>)</span><br><span class="line">    fc2 = fluid.layers.fc(drop2, size=<span class="number">256</span>, act=<span class="literal">None</span>)</span><br><span class="line">    fc3 = fluid.layers.fc(fc2, size=<span class="number">10</span>, act=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fc3</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 当前使用的模型</span></span><br><span class="line"><span class="comment"># model = lenet_5_net()</span></span><br><span class="line">model = vgg_net()</span><br><span class="line"><span class="comment"># CPU</span></span><br><span class="line"><span class="comment"># place = fluid.CPUPlace()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GPU</span></span><br><span class="line">place = fluid.CUDAPlace(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 输入的原始图像数据，大小为 1 * 28 * 28</span></span><br><span class="line">image = fluid.layers.data(name=<span class="string">&quot;image&quot;</span>, shape=[<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>], dtype=<span class="string">&quot;float32&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入图片的标签</span></span><br><span class="line">label = fluid.layers.data(name=<span class="string">&quot;label&quot;</span>, shape=[<span class="number">1</span>], dtype=<span class="string">&quot;int64&quot;</span>)</span><br><span class="line"><span class="comment"># 告知网络传入的数据分为两部分，第一部分是 image 值，第二部分是 label 值</span></span><br><span class="line">feeder = fluid.DataFeeder(feed_list=[image, label], place=place)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交叉熵损失函数</span></span><br><span class="line">cost_function = fluid.layers.cross_entropy(<span class="built_in">input</span>=model, label=label)</span><br><span class="line"><span class="comment"># 平均损失</span></span><br><span class="line">avg_cost = fluid.layers.mean(cost_function)</span><br><span class="line"><span class="comment"># 计算分类准确率</span></span><br><span class="line">acc = fluid.layers.accuracy(<span class="built_in">input</span>=model, label=label)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习率</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.0005</span></span><br><span class="line"><span class="comment"># LEARNING_RATE = 0.001</span></span><br><span class="line">LEARNING_RATE = <span class="number">0.0015</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Adam 优化器</span></span><br><span class="line">optimizer = fluid.optimizer.Adam(learning_rate=LEARNING_RATE)</span><br><span class="line"><span class="comment"># SGD 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.SGD(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># RMSProp 优化器</span></span><br><span class="line"><span class="comment"># optimizer = fluid.optimizer.RMSProp(learning_rate=LEARNING_RATE)</span></span><br><span class="line"><span class="comment"># Adagrad 优化器</span></span><br><span class="line"><span class="comment">#optimizer = fluid.optimizer.AdagradOptimizer(learning_rate=LEARNING_RATE)</span></span><br><span class="line"></span><br><span class="line">opts = optimizer.minimize(avg_cost)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代轮数</span></span><br><span class="line">EPOCHS = <span class="number">15</span></span><br><span class="line"><span class="comment"># 保存路径</span></span><br><span class="line">save_path = <span class="string">&quot;/home/aistudio/work/hand_inference.model&quot;</span></span><br><span class="line"></span><br><span class="line">executor = fluid.Executor(place)</span><br><span class="line">executor.run(fluid.default_startup_program())</span><br><span class="line">main_program = fluid.default_main_program()</span><br><span class="line">test_program = fluid.default_main_program().clone(for_test=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">step = <span class="number">0</span></span><br><span class="line">lists = []</span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line">z = []</span><br><span class="line"></span><br><span class="line">predict_output_list = []</span><br><span class="line">answer_output_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> train_time <span class="keyword">in</span> <span class="built_in">range</span>(EPOCHS):</span><br><span class="line">    <span class="keyword">for</span> step_id, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_reader()):</span><br><span class="line">        metrics = executor.run(main_program, feed=feeder.feed(data), fetch_list=[avg_cost, acc])</span><br><span class="line">        <span class="comment"># 每 200 个打印一次</span></span><br><span class="line">        <span class="keyword">if</span> step % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;==&gt; 训练次数：%d  ==&gt; 训练轮数：%d  ==&gt; 损失：%f&quot;</span> % (step, train_time, metrics[<span class="number">0</span>]))</span><br><span class="line">        step += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证</span></span><br><span class="line">    acc_list = []</span><br><span class="line">    avg_loss_list = []</span><br><span class="line">    <span class="keyword">for</span> test_data <span class="keyword">in</span> test_reader():</span><br><span class="line">        predict_output, acc_np, avg_np = executor.run(program=test_program, feed=feeder.feed(test_data), fetch_list=[model, acc, avg_cost])</span><br><span class="line">        acc_list.append(acc_np)</span><br><span class="line">        avg_loss_list.append(avg_np)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 记录验证时的结果和输出</span></span><br><span class="line">        <span class="keyword">if</span> train_time == EPOCHS - <span class="number">1</span>:</span><br><span class="line">            predict_output_list.append(predict_output)</span><br><span class="line">            answer_output_list.append([<span class="built_in">int</span>(d[<span class="number">1</span>]) <span class="keyword">for</span> d <span class="keyword">in</span> test_data])</span><br><span class="line"></span><br><span class="line">    acc_val_mean = np.array(acc_list).mean()</span><br><span class="line">    avg_loss_mean = np.array(avg_loss_list).mean()</span><br><span class="line">    lists.append((train_time, avg_loss_mean, acc_val_mean))</span><br><span class="line"></span><br><span class="line">    x.append(train_time)</span><br><span class="line">    y.append(acc_val_mean)</span><br><span class="line">    z.append(avg_loss_mean)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印本轮信息</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;======&gt; 第 %d 轮 ======&gt; 平均损失率：%s ======&gt; 平均准确度：%s\n&quot;</span> % (train_time, avg_loss_mean, acc_val_mean))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> save_path <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        fluid.io.save_inference_model(save_path, [<span class="string">&quot;image&quot;</span>], [model], executor, model_filename=<span class="literal">None</span>, params_filename=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">best = <span class="built_in">sorted</span>(lists, key=<span class="keyword">lambda</span> <span class="built_in">list</span>: <span class="built_in">float</span>(<span class="built_in">list</span>[<span class="number">1</span>]))[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;==========&gt; 最好为第 %s 轮数：平均损失率：%s &lt;==========&quot;</span> % (best[<span class="number">0</span>], best[<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;==========&gt; 分类准确度：%.2f%% &lt;==========&quot;</span> % (<span class="built_in">float</span>(best[<span class="number">2</span>]) * <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>, <span class="number">7</span>))</span><br><span class="line">plt.title(<span class="string">&quot;Valid Accuracy and Loss&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Accuracy/Loss&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Epochs&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;g*-&#x27;</span>, linewidth=<span class="number">2</span>,label=<span class="string">&quot;Valid Accuracy&quot;</span>)</span><br><span class="line">plt.plot(x, z, <span class="string">&#x27;b*-&#x27;</span>, linewidth=<span class="number">2</span>,label=<span class="string">&quot;Avg Loss&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> x_label, y_label <span class="keyword">in</span> <span class="built_in">zip</span>(x, y):</span><br><span class="line">    plt.text(x_label, y_label, (<span class="built_in">format</span>(y_label, <span class="string">&quot;.3f&quot;</span>)), ha=<span class="string">&quot;center&quot;</span>, va=<span class="string">&quot;bottom&quot;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> x_label, z_label <span class="keyword">in</span> <span class="built_in">zip</span>(x, z):</span><br><span class="line">    plt.text(x_label, z_label, (<span class="built_in">format</span>(z_label, <span class="string">&quot;.3f&quot;</span>)), ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;准确率与损失图&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">predict_label_list = []</span><br><span class="line">answer_label_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> predict_output <span class="keyword">in</span> np.array(predict_output_list):</span><br><span class="line">    <span class="keyword">for</span> label <span class="keyword">in</span> predict_output:</span><br><span class="line">        predict_label_list.append(np.argsort(label)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> answer_output <span class="keyword">in</span> np.array(answer_output_list):</span><br><span class="line">    <span class="keyword">for</span> label <span class="keyword">in</span> answer_output:</span><br><span class="line">        answer_label_list.append(label)</span><br><span class="line"></span><br><span class="line">sns.<span class="built_in">set</span>()</span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">8</span>, <span class="number">7</span>))</span><br><span class="line">C2 = confusion_matrix(answer_label_list, predict_label_list, labels=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">TX = sns.heatmap(C2, annot=<span class="literal">True</span>, ax=ax, cmap=<span class="string">&quot;YlGnBu&quot;</span>, fmt=<span class="string">&quot;.20g&quot;</span>)</span><br><span class="line">ax.set_title(<span class="string">&quot;Confusion Matrix&quot;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&quot;Predict&quot;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&quot;Test_label&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;混淆矩阵&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_image</span>(<span class="params">file</span>):</span><br><span class="line">    im = Image.<span class="built_in">open</span>(file).convert(<span class="string">&quot;L&quot;</span>)                        <span class="comment">#将RGB转化为灰度图像，L代表灰度图像，像素值在0~255之间</span></span><br><span class="line">    im = im.resize((<span class="number">28</span>, <span class="number">28</span>), Image.ANTIALIAS)                 <span class="comment">#resize image with high-quality 图像大小为28*28</span></span><br><span class="line">    im = np.array(im).reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>).astype(np.float32)<span class="comment">#返回新形状的数组,把它变成一个 numpy 数组以匹配数据馈送格式。</span></span><br><span class="line">    im = im / <span class="number">255.0</span> * <span class="number">2.0</span> - <span class="number">1.0</span>                               <span class="comment">#归一化到【-1~1】之间</span></span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"></span><br><span class="line">image_2 = load_image(<span class="string">&quot;/home/aistudio/data/data36916/white_3.png&quot;</span>)</span><br><span class="line">image_9 = load_image(<span class="string">&quot;/home/aistudio/data/data36916/black_9.jpg&quot;</span>)</span><br><span class="line"></span><br><span class="line">executor = fluid.Executor(place)</span><br><span class="line">inference_scope = fluid.core.Scope()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> fluid.scope_guard(inference_scope):</span><br><span class="line">    <span class="comment"># 加载模型</span></span><br><span class="line">    [inference_program, feed_target_names, fetch_targets] = fluid.io.load_inference_model(save_path, executor, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 运行识别</span></span><br><span class="line">    results = executor.run(inference_program, feed=&#123;feed_target_names[<span class="number">0</span>]: image_2&#125;, fetch_list=fetch_targets)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取概率最大的 label</span></span><br><span class="line">    lab = np.argsort(results)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示图片</span></span><br><span class="line">    plt.imshow(Image.<span class="built_in">open</span>(<span class="string">&quot;/home/aistudio/data/data36916/white_3.png&quot;</span>))</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出这张图片的识别结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这张白底黑字的数字 3 的识别结果是: %d&quot;</span> % lab[<span class="number">0</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">executor = fluid.Executor(place)</span><br><span class="line">inference_scope = fluid.core.Scope()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> fluid.scope_guard(inference_scope):</span><br><span class="line">    <span class="comment"># 加载模型</span></span><br><span class="line">    [inference_program, feed_target_names, fetch_targets] = fluid.io.load_inference_model(save_path, executor, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 运行识别</span></span><br><span class="line">    results = executor.run(inference_program, feed=&#123;feed_target_names[<span class="number">0</span>]: image_9&#125;, fetch_list=fetch_targets)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取概率最大的 label</span></span><br><span class="line">    lab = np.argsort(results)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示图片</span></span><br><span class="line">    plt.imshow(Image.<span class="built_in">open</span>(<span class="string">&quot;/home/aistudio/data/data36916/black_8.jpg&quot;</span>))</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出这张图片的识别结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这张黑底白字的数字 9 的识别结果是: %d&quot;</span> % lab[<span class="number">0</span>][<span class="number">0</span>][-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Star</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/03/01/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">http://example.com/2022/03/01/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Star's Wrold</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/02/09/%E5%91%A8%E5%BF%97%E5%8D%8E%E3%80%8AMachine%20Learning%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(6)--%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><img class="next-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">机器学习——人工神经网络</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/83267809?s=400&amp;u=e07dedcddde59bae22039fbfb223e27ee9c35a29&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Star</div><div class="author-info__description">小小HNU菜鸡一枚的随手记录</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Star-xing1"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a><a class="social-icon" href="mailto:star_lfx@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Keep going</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A"><span class="toc-number">1.</span> <span class="toc-text">人工智能导论课程实验四实验报告</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C%E5%90%8D%E7%A7%B0%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E5%8F%8A%E5%BA%94%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">一、实验名称：深度学习算法及应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.</span> <span class="toc-text">二、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-number">1.3.</span> <span class="toc-text">三、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E7%AE%97%E6%B3%95%E5%8F%8A%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">四、实验算法及原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN"><span class="toc-number">1.4.1.</span> <span class="toc-text">深度学习与卷积神经网络CNN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CNN%E7%9A%84%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.2.</span> <span class="toc-text">CNN的训练过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">1.卷积神经网络的前向传播过程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%E4%B8%AD%E7%9A%84%E5%8D%B7%E7%A7%AF%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.2.1.1.</span> <span class="toc-text">1.1 前向传播中的卷积操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%E4%B8%AD%E7%9A%84%E6%B1%A0%E5%8C%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.2.1.2.</span> <span class="toc-text">1.2 前向传播中的池化操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-%E5%89%8D%E5%90%91%E4%BC%A0%E6%92%AD%E4%B8%AD%E7%9A%84%E5%85%A8%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.4.2.1.3.</span> <span class="toc-text">1.3 前向传播中的全连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.3.</span> <span class="toc-text">2.卷积神经网络的反向传播过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E6%9D%83%E5%80%BC%E6%9B%B4%E6%96%B0"><span class="toc-number">1.4.4.</span> <span class="toc-text">3.卷积神经网络的权值更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%E5%8F%8A%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.</span> <span class="toc-text">五、实验内容及步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%87%86%E5%A4%87"><span class="toc-number">1.5.1.</span> <span class="toc-text">数据集准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">数据集介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.5.2.</span> <span class="toc-text">数据预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E5%B9%B6%E8%A7%A3%E6%9E%90%E6%A0%87%E7%AD%BE"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">加载并解析标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87%E5%B9%B6%E5%88%9B%E5%BB%BA-reader"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">预处理图片并创建 reader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E6%B7%B7%E5%90%88%E5%B9%B6%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">数据集混合并随机选择</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA"><span class="toc-number">1.5.3.</span> <span class="toc-text">网络搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LeNet-5"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">LeNet-5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VGG"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">VGG</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.5.4.</span> <span class="toc-text">训练配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83%E6%96%B9%E5%BC%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">训练方式定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%82%E5%AE%9A%E4%B9%89"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">数据层定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">数据转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E5%87%86%E7%A1%AE%E7%8E%87"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">定义损失函数和准确率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%BC%98%E5%8C%96%E5%99%A8%E5%92%8C%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">1.5.4.5.</span> <span class="toc-text">定义优化器和学习率</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">1.5.5.</span> <span class="toc-text">模型训练</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">参数设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">训练</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0"><span class="toc-number">1.5.6.</span> <span class="toc-text">模型评估</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B9%B6%E7%BB%98%E5%88%B6%E5%87%86%E7%A1%AE%E7%8E%87%E4%B8%8E%E6%8D%9F%E5%A4%B1%E5%9B%BE"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">计算并绘制准确率与损失图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B9%B6%E7%BB%98%E5%88%B6%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">计算并绘制混淆矩阵</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E5%8F%8A%E5%88%86%E6%9E%90"><span class="toc-number">1.6.</span> <span class="toc-text">六、实验结果及分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.6.1.</span> <span class="toc-text">实验结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90"><span class="toc-number">1.6.2.</span> <span class="toc-text">结果分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%80%9D%E8%80%83%E9%A2%98"><span class="toc-number">1.7.</span> <span class="toc-text">七、思考题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97"><span class="toc-number">1.8.</span> <span class="toc-text">八、实验心得</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95%EF%BC%9A%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">1.9.</span> <span class="toc-text">附录：完整代码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/01/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%AF%BC%E8%AE%BA%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E5%9B%9B%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/" title="人工智能导论课程实验四">人工智能导论课程实验四</a><time datetime="2022-03-01T15:20:13.591Z" title="发表于 2022-03-01 23:20:13">2022-03-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/02/09/%E5%91%A8%E5%BF%97%E5%8D%8E%E3%80%8AMachine%20Learning%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(6)--%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" title="机器学习——人工神经网络">机器学习——人工神经网络</a><time datetime="2022-02-09T10:00:27.309Z" title="发表于 2022-02-09 18:00:27">2022-02-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/02/09/hello-world/" title="Hello World">Hello World</a><time datetime="2022-02-09T07:18:24.845Z" title="发表于 2022-02-09 15:18:24">2022-02-09</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2022/02/09/I2byczl6NTZXmMH.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Star</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'pneUrgY3NmkGQj3umRmPAyqf-9Nh9j0Va',
      appKey: 'LWt9crAegmlGDzsPApoC6emw',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>